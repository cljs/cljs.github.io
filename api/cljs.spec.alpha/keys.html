<html><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>cljs.spec.alpha/keys</title><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" /><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" /><link href="/css/normalize.css" rel="stylesheet" /><link href="/css/skeleton.css" rel="stylesheet" /><link href="/css/custom.css" rel="stylesheet" /><link href="/css/github-theme.css" rel="stylesheet" /><link href="/img/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57" /><link href="/img/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114" /><link href="/img/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72" /><link href="/img/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144" /><link href="/img/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60" /><link href="/img/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" /><link href="/img/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" /><link href="/img/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" /><link href="/img/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" /><link href="/img/icons/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png" /><link href="/img/icons/favicon-160x160.png" rel="icon" sizes="160x160" type="image/png" /><link href="/img/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png" /><link href="/img/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="/img/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /></head><body><div class="container"><nav class="navbar"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link-logo"><img class="navbar-logo" src="/img/cljs-white.svg" /></a></li><li class="navbar-item"><a class="navbar-title">ClojureScript</a></li><li class="navbar-item"><a class="navbar-link" href="/api">API</a></li><li class="navbar-item"><a class="navbar-link" href="https://github.com/clojure/clojurescript" target="_blank">GitHub</a></li></ul></div></nav><div><h1 class="r">cljs.spec.alpha/keys</h1><table><tr><td>macro</td><td>previously <a href="/api/cljs.spec/keys">cljs.spec/keys</a></td><td><a href="https://clojure.github.io/spec.alpha/clojure.spec.alpha-api.html#clojure.spec.alpha/keys"><img height="24px" src="/img/clojure-icon.gif" valign="middle" /> clojure.spec.alpha/keys</a></td><td><a href="https://github.com/cljs/api/blob/master/docfiles/cljs.spec.alpha/keys.md">Edit</a></td></tr></table><div><code>(keys & {:keys [req req-un opt opt-un gen]})</code></div><hr />Source docstring:<pre>Creates and returns a map validating spec. :req and :opt are both
vectors of namespaced-qualified keywords. The validator will ensure
the :req keys are present. The :opt keys serve as documentation and
may be used by the generator.

The :req key vector supports 'and' and 'or' for key groups:

(s/keys :req [::x ::y (or ::secret (and ::user ::pwd))] :opt [::z])

There are also -un versions of :req and :opt. These allow
you to connect unqualified keys to specs.  In each case, fully
qualfied keywords are passed, which name the specs, but unqualified
keys (with the same name component) are expected and checked at
conform-time, and generated during gen:

(s/keys :req-un [:my.ns/x :my.ns/y])

The above says keys :x and :y are required, and will be validated
and generated by specs (if they exist) named :my.ns/x :my.ns/y
respectively.

In addition, the values of *all* namespace-qualified keys will be validated
(and possibly destructured) by any registered specs. Note: there is
no support for inline value specification, by design.

Optionally takes :gen generator-fn, which must be a fn of no args that
returns a test.check generator.</pre><div>Source code @ <a href="https://github.com/clojure/clojurescript/blob/r1.12.116/src/main/cljs/cljs/spec/alpha.cljc#L135-L195">clojurescript:src/main/cljs/cljs/spec/alpha.cljc</a></div><pre><code class="syntax"><span class="s-exp">(</span><span class="definition">defmacro</span> <span class="core-fn">keys</span>
  <span class="s-exp">[</span><span class="reader-char">&</span> <span class="s-exp">{</span><span class="keyword">:keys</span> <span class="s-exp">[</span><span class="symbol">req</span> <span class="symbol">req-un</span> <span class="symbol">opt</span> <span class="symbol">opt-un</span> <span class="symbol">gen</span><span class="s-exp">]</span><span class="s-exp">}</span><span class="s-exp">]</span>
  <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="symbol">unk</span> <span class="reader-char">#</span><span class="s-exp">(</span><span class="macro">-></span> <span class="keyword">%</span> <span class="core-fn">name</span> <span class="core-fn">keyword</span><span class="s-exp">)</span>
        <span class="symbol">req-keys</span> <span class="s-exp">(</span><span class="core-fn">filterv</span> <span class="core-fn">keyword?</span> <span class="s-exp">(</span><span class="core-fn">flatten</span> <span class="symbol">req</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">req-un-specs</span> <span class="s-exp">(</span><span class="core-fn">filterv</span> <span class="core-fn">keyword?</span> <span class="s-exp">(</span><span class="core-fn">flatten</span> <span class="symbol">req-un</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">_</span> <span class="s-exp">(</span><span class="macro">clojure.core/assert</span> <span class="s-exp">(</span><span class="core-fn">every?</span> <span class="reader-char">#</span><span class="s-exp">(</span><span class="macro">clojure.core/and</span> <span class="s-exp">(</span><span class="core-fn">keyword?</span> <span class="keyword">%</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">namespace</span> <span class="keyword">%</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">concat</span> <span class="symbol">req-keys</span> <span class="symbol">req-un-specs</span> <span class="symbol">opt</span> <span class="symbol">opt-un</span><span class="s-exp">)</span><span class="s-exp">)</span>
                  <span class="string">"all keys must be namespace-qualified keywords"</span><span class="s-exp">)</span>
        <span class="symbol">req-specs</span> <span class="s-exp">(</span><span class="core-fn">into</span> <span class="symbol">req-keys</span> <span class="symbol">req-un-specs</span><span class="s-exp">)</span>
        <span class="symbol">req-keys</span> <span class="s-exp">(</span><span class="core-fn">into</span> <span class="symbol">req-keys</span> <span class="s-exp">(</span><span class="core-fn">map</span> <span class="symbol">unk</span> <span class="symbol">req-un-specs</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">opt-keys</span> <span class="s-exp">(</span><span class="core-fn">into</span> <span class="s-exp">(</span><span class="core-fn">vec</span> <span class="symbol">opt</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">map</span> <span class="symbol">unk</span> <span class="symbol">opt-un</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">opt-specs</span> <span class="s-exp">(</span><span class="core-fn">into</span> <span class="s-exp">(</span><span class="core-fn">vec</span> <span class="symbol">opt</span><span class="s-exp">)</span> <span class="symbol">opt-un</span><span class="s-exp">)</span>
        <span class="symbol">gx</span> <span class="s-exp">(</span><span class="core-fn">gensym</span><span class="s-exp">)</span>
        <span class="symbol">parse-req</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">rk</span> <span class="symbol">f</span><span class="s-exp">]</span>
                    <span class="s-exp">(</span><span class="core-fn">map</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">x</span><span class="s-exp">]</span>
                           <span class="s-exp">(</span><span class="special-form">if</span> <span class="s-exp">(</span><span class="core-fn">keyword?</span> <span class="symbol">x</span><span class="s-exp">)</span>
                             <span class="reader-char">`</span><span class="s-exp">(</span><span class="core-fn">contains?</span> <span class="reader-char">~</span><span class="symbol">gx</span> <span class="reader-char">~</span><span class="s-exp">(</span><span class="symbol">f</span> <span class="symbol">x</span><span class="s-exp">)</span><span class="s-exp">)</span>
                             <span class="s-exp">(</span><span class="symbol">walk/postwalk</span>
                               <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">y</span><span class="s-exp">]</span> <span class="s-exp">(</span><span class="special-form">if</span> <span class="s-exp">(</span><span class="core-fn">keyword?</span> <span class="symbol">y</span><span class="s-exp">)</span> <span class="reader-char">`</span><span class="s-exp">(</span><span class="core-fn">contains?</span> <span class="reader-char">~</span><span class="symbol">gx</span> <span class="reader-char">~</span><span class="s-exp">(</span><span class="symbol">f</span> <span class="symbol">y</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="symbol">y</span><span class="s-exp">)</span><span class="s-exp">)</span>
                               <span class="symbol">x</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
                         <span class="symbol">rk</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">pred-exprs</span> <span class="s-exp">[</span><span class="reader-char">`</span><span class="s-exp">(</span><span class="core-fn">map?</span> <span class="reader-char">~</span><span class="symbol">gx</span><span class="s-exp">)</span><span class="s-exp">]</span>
        <span class="symbol">pred-exprs</span> <span class="s-exp">(</span><span class="core-fn">into</span> <span class="symbol">pred-exprs</span> <span class="s-exp">(</span><span class="symbol">parse-req</span> <span class="symbol">req</span> <span class="core-fn">identity</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">pred-exprs</span> <span class="s-exp">(</span><span class="core-fn">into</span> <span class="symbol">pred-exprs</span> <span class="s-exp">(</span><span class="symbol">parse-req</span> <span class="symbol">req-un</span> <span class="symbol">unk</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">keys-pred</span> <span class="reader-char">`</span><span class="s-exp">(</span><span class="symbol">fn*</span> <span class="s-exp">[</span><span class="reader-char">~</span><span class="symbol">gx</span><span class="s-exp">]</span> <span class="s-exp">(</span><span class="symbol">c/and</span> <span class="reader-char">~@</span><span class="symbol">pred-exprs</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="symbol">pred-exprs</span> <span class="s-exp">(</span><span class="core-fn">mapv</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">e</span><span class="s-exp">]</span> <span class="reader-char">`</span><span class="s-exp">(</span><span class="symbol">fn*</span> <span class="s-exp">[</span><span class="reader-char">~</span><span class="symbol">gx</span><span class="s-exp">]</span> <span class="reader-char">~</span><span class="symbol">e</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="symbol">pred-exprs</span><span class="s-exp">)</span>
        <span class="symbol">pred-forms</span> <span class="s-exp">(</span><span class="symbol">walk/postwalk</span> <span class="reader-char">#</span><span class="s-exp">(</span><span class="symbol">res</span> <span class="symbol">&env</span> <span class="keyword">%</span><span class="s-exp">)</span> <span class="symbol">pred-exprs</span><span class="s-exp">)</span><span class="s-exp">]</span>
    <span class="comment">;; `(map-spec-impl ~req-keys '~req ~opt '~pred-forms ~pred-exprs ~gen)
</span>    <span class="reader-char">`</span><span class="s-exp">(</span><span class="symbol">map-spec-impl</span> <span class="s-exp">{</span><span class="keyword">:req</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">req</span> <span class="keyword">:opt</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">opt</span> <span class="keyword">:req-un</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">req-un</span> <span class="keyword">:opt-un</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">opt-un</span>
                     <span class="keyword">:req-keys</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">req-keys</span> <span class="keyword">:req-specs</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">req-specs</span>
                     <span class="keyword">:opt-keys</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">opt-keys</span> <span class="keyword">:opt-specs</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">opt-specs</span>
                     <span class="keyword">:pred-forms</span> <span class="reader-char">'</span><span class="reader-char">~</span><span class="symbol">pred-forms</span>
                     <span class="keyword">:pred-exprs</span> <span class="reader-char">~</span><span class="symbol">pred-exprs</span>
                     <span class="keyword">:keys-pred</span> <span class="reader-char">~</span><span class="symbol">keys-pred</span>
                     <span class="keyword">:gfn</span> <span class="reader-char">~</span><span class="symbol">gen</span><span class="s-exp">}</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span></code></pre><hr /></div><footer class="site-footer"><div class="wrapper"><hr /><div class="cljs-legal">ClojureScript is licensed <a href="http://opensource.org/licenses/eclipse-1.0.php">EPL 1.0</a><br />Copyright Â© Rich Hickey</div></div></footer></div><script src="/js/client.js"></script></body></html>