<html><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>CLJS - def</title><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" /><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" /><link href="/css/normalize.css" rel="stylesheet" /><link href="/css/skeleton.css" rel="stylesheet" /><link href="/css/custom.css" rel="stylesheet" /><link href="/css/github-theme.css" rel="stylesheet" /><link href="/img/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57" /><link href="/img/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114" /><link href="/img/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72" /><link href="/img/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144" /><link href="/img/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60" /><link href="/img/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" /><link href="/img/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" /><link href="/img/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" /><link href="/img/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" /><link href="/img/icons/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png" /><link href="/img/icons/favicon-160x160.png" rel="icon" sizes="160x160" type="image/png" /><link href="/img/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png" /><link href="/img/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="/img/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /></head><body><div class="container"><nav class="navbar"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link-logo"><img class="navbar-logo" src="/img/cljs-white.svg" /></a></li><li class="navbar-item"><a class="navbar-title">ClojureScript</a></li><li class="navbar-item"><a class="navbar-link" href="/api">API</a></li><li class="navbar-item"><a class="navbar-link" href="/news">News</a></li><li class="navbar-item"><a class="navbar-link" href="https://github.com/clojure/clojurescript" target="_blank">GitHub</a></li></ul></div></nav><div><h1>def</h1><em>known as define</em><table><tr><td>special form</td><td>Added in 0.0-927</td><td><a href="http://clojure.github.io/clojure/branch-master/clojure.core-api.html#clojure.core/def"><img height="24px" src="/img/clojure-icon.gif" valign="middle" /> clojure.core/def</a></td></tr></table><div><code>(def symbol doc-string? init?)</code></div><hr /><h3>Details:</h3><div><p>Creates a global variable with the name of <code>symbol</code> and a namespace of the
current namespace.</p>
<p>If <code>init</code> is supplied, it is evaluated and the result is assigned to <code>symbol</code>.</p>
<p><code>doc-string</code> is an optional documentation string.</p>
<p><code>def</code> is one of ClojureScript&#39;s <a href="http://clojure.org/special_forms">special forms</a>
and is used by many macros to define common elements (ie: <code>defn</code>, <code>defmacro</code>,
etc).</p>
<p>Supported metadata:</p>
<ul>
<li><code>^{:private boolean}</code> - make non-accessible from other namespaces</li>
<li><code>^{:dynamic boolean}</code> - make <a href="/api/cljs.core/binding">dynamically bindable</a> (usually named with <a class="code-link" href="/api/syntax/earmuffs"><code>*earmuffs*</code></a>)</li>
<li><code>^{:const boolean}</code> - prevents redef and allows it to be used in <a class="code-link" href="/api/cljs.core/case"><code>case</code></a>.</li>
<li><code>^{:jsdoc [&quot;...&quot;]}</code> - vector of JSDoc Tags for <a href="https://developers.google.com/closure/compiler/docs/js-for-compiler?hl=en#tags">Google Closure</a> or <a href="http://usejsdoc.org/#block-tags">standard</a>.</li>
<li><code>^{:test (fn [] (assert ...))}</code> - allows function to be tested with <a class="code-link" href="/api/cljs.core/test"><code>test</code></a>.</li>
<li><code>^{:doc &quot;...&quot;}</code> - doc-string (prefer the use of the <code>(def symbol doc-string init)</code>)</li>
<li><code>^{:export boolean}</code> - make this var publicly accessible from JS, using <code>goog.exportSymbol</code></li>
</ul>
<p>Compiler will also add metadata:</p>
<ul>
<li><code>:ns</code></li>
<li><code>:name</code></li>
<li><code>:file</code></li>
<li><code>:line</code>, <code>:end-line</code></li>
<li><code>:column</code>, <code>:end-column</code></li>
<li><code>:source</code></li>
<li><code>:arglists</code></li>
</ul>
</div><hr /><h3>Examples:</h3><div><pre><code class="lang-clj">(def a)
a
;;=&gt; nil

(def b 42)
b
;;=&gt; 42

(def c "an optional docstring" 42)
c
;;=&gt; 42
</code></pre>
</div><hr /><h3>See Also:</h3><ul><li><a href="/api/cljs.core/defn">defn</a></li><li><a href="/api/cljs.core/fn">fn</a></li><li><a href="/api/cljs.core/defmacro">defmacro</a></li><li><a href="/api/cljs.core/defmulti">defmulti</a></li></ul><hr />Source docstring:<pre>Creates and interns a global var with the name
of symbol in the current namespace (*ns*) or locates such a var if
it already exists.  If init is supplied, it is evaluated, and the
root binding of the var is set to the resulting value.  If init is
not supplied, the root binding of the var is unaffected.</pre><div>Parser code @ <a href="https://github.com/clojure/clojurescript/blob/r1.9.495/src/main/clojure/cljs/analyzer.cljc#L1266-L1409">clojurescript:src/main/clojure/cljs/analyzer.cljc</a></div><pre><code>(<span class="hljs-name"><span class="hljs-builtin-name">defmethod</span></span> parse 'def
  [op env form _ _]
  (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> [pfn (<span class="hljs-name"><span class="hljs-builtin-name">fn</span></span>
              ([_ sym] {<span class="hljs-symbol">:sym</span> sym})
              ([_ sym init] {<span class="hljs-symbol">:sym</span> sym <span class="hljs-symbol">:init</span> init})
              ([_ sym doc init] {<span class="hljs-symbol">:sym</span> sym <span class="hljs-symbol">:doc</span> doc <span class="hljs-symbol">:init</span> init}))
        args (<span class="hljs-name"><span class="hljs-builtin-name">apply</span></span> pfn form)
        sym (<span class="hljs-symbol">:sym</span> args)
        sym-meta (<span class="hljs-name"><span class="hljs-builtin-name">meta</span></span> sym)
        tag (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:tag</span>)
        protocol (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:protocol</span> valid-proto)
        dynamic (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:dynamic</span>)
        ns-name (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> env <span class="hljs-symbol">:ns</span> <span class="hljs-symbol">:name</span>)
        locals (<span class="hljs-symbol">:locals</span> env)
        clash-ns (<span class="hljs-name"><span class="hljs-builtin-name">symbol</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">str</span></span> ns-name <span class="hljs-string">"."</span> sym))
        sym-ns   (<span class="hljs-name"><span class="hljs-builtin-name">namespace</span></span> sym)
        sym      (<span class="hljs-name"><span class="hljs-builtin-name">cond</span></span>
                   (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> sym-ns (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> #?(<span class="hljs-symbol">:clj</span>  (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">symbol</span></span> sym-ns) ns-name)
                                       <span class="hljs-symbol">:cljs</span> (<span class="hljs-name">symbol-identical?</span> (<span class="hljs-name"><span class="hljs-builtin-name">symbol</span></span> sym-ns) ns-name))))
                   (<span class="hljs-name"><span class="hljs-builtin-name">throw</span></span> (<span class="hljs-name">error</span> env (<span class="hljs-name"><span class="hljs-builtin-name">str</span></span> <span class="hljs-string">"Can't def ns-qualified name in namespace "</span> sym-ns)))

                   (<span class="hljs-name">some?</span> sym-ns)
                   (<span class="hljs-name"><span class="hljs-builtin-name">symbol</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">name</span></span> sym))

                   <span class="hljs-symbol">:else</span> sym)]
    (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name">some?</span> (<span class="hljs-name"><span class="hljs-builtin-name">get-in</span></span> @env/*compiler* [:<span class="hljs-symbol">:namespaces</span> clash-ns]))
      (<span class="hljs-name">warning</span> <span class="hljs-symbol">:ns-var-clash</span> env
        {<span class="hljs-symbol">:ns</span> (<span class="hljs-name"><span class="hljs-builtin-name">symbol</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">str</span></span> ns-name <span class="hljs-string">"."</span> sym))
         <span class="hljs-symbol">:var</span> (<span class="hljs-name"><span class="hljs-builtin-name">symbol</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">str</span></span> ns-name) (<span class="hljs-name"><span class="hljs-builtin-name">str</span></span> sym))}))
    (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name">some?</span> (<span class="hljs-symbol">:const</span> (<span class="hljs-name">resolve-var</span> (<span class="hljs-name"><span class="hljs-builtin-name">dissoc</span></span> env <span class="hljs-symbol">:locals</span>) sym)))
      (<span class="hljs-name"><span class="hljs-builtin-name">throw</span></span> (<span class="hljs-name">error</span> env <span class="hljs-string">"Can't redefine a constant"</span>)))
    (<span class="hljs-name">when-some</span> [doc (<span class="hljs-symbol">:doc</span> args)]
      (<span class="hljs-name"><span class="hljs-builtin-name">when-not</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">string?</span></span> doc)
        (<span class="hljs-name"><span class="hljs-builtin-name">throw</span></span> (<span class="hljs-name">error</span> env <span class="hljs-string">"Too many arguments to def"</span>))))
    (<span class="hljs-name">when-some</span> [v (<span class="hljs-name"><span class="hljs-builtin-name">get-in</span></span> @env/*compiler* [:<span class="hljs-symbol">:namespaces</span> ns-name <span class="hljs-symbol">:defs</span> sym])]
      (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> *allow-redef*)
                 (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> (<span class="hljs-symbol">:declared</span> v))
                 (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> (<span class="hljs-symbol">:declared</span> sym-meta))
                 *file-defs*
                 (<span class="hljs-name"><span class="hljs-builtin-name">get</span></span> @*file-defs* sym))
        (<span class="hljs-name">warning</span> <span class="hljs-symbol">:redef-in-file</span> env {<span class="hljs-symbol">:sym</span> sym <span class="hljs-symbol">:line</span> (<span class="hljs-symbol">:line</span> v)})))
    (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> *file-defs*
      (<span class="hljs-name"><span class="hljs-builtin-name">swap!</span></span> *file-defs* conj sym))
    (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> [env (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">or</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">not=</span></span> ns-name 'cljs.core)
                           (<span class="hljs-name">core-name?</span> env sym))
                      (<span class="hljs-name">some?</span> (<span class="hljs-name"><span class="hljs-builtin-name">get-in</span></span> @env/*compiler* [:<span class="hljs-symbol">:namespaces</span> ns-name <span class="hljs-symbol">:uses</span> sym])))
                (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> [ev (<span class="hljs-name">resolve-existing-var</span> (<span class="hljs-name"><span class="hljs-builtin-name">dissoc</span></span> env <span class="hljs-symbol">:locals</span>) sym)
                      conj-to-set (<span class="hljs-name">fnil</span> conj #{})]
                  (<span class="hljs-name">warning</span> <span class="hljs-symbol">:redef</span> env {<span class="hljs-symbol">:sym</span> sym <span class="hljs-symbol">:ns</span> (<span class="hljs-symbol">:ns</span> ev) <span class="hljs-symbol">:ns-name</span> ns-name})
                  (<span class="hljs-name"><span class="hljs-builtin-name">swap!</span></span> env/*compiler* update-in [:<span class="hljs-symbol">:namespaces</span> ns-name <span class="hljs-symbol">:excludes</span>]
                     conj-to-set sym)
                  (<span class="hljs-name"><span class="hljs-builtin-name">update-in</span></span> env [<span class="hljs-symbol">:ns</span> <span class="hljs-symbol">:excludes</span>] conj-to-set sym))
                env)
          var-name (<span class="hljs-symbol">:name</span> (<span class="hljs-name">resolve-var</span> (<span class="hljs-name"><span class="hljs-builtin-name">dissoc</span></span> env <span class="hljs-symbol">:locals</span>) sym))
          init-expr (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">contains?</span></span> args <span class="hljs-symbol">:init</span>)
                      (<span class="hljs-name"><span class="hljs-builtin-name">swap!</span></span> env/*compiler* assoc-in [:<span class="hljs-symbol">:namespaces</span> ns-name <span class="hljs-symbol">:defs</span> sym]
                        (<span class="hljs-name"><span class="hljs-builtin-name">merge</span></span>
                          {<span class="hljs-symbol">:name</span> var-name}
                          sym-meta
                          (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">true?</span></span> dynamic) {<span class="hljs-symbol">:dynamic</span> <span class="hljs-literal">true</span>})
                          (<span class="hljs-name">source-info</span> var-name env)))
                      (<span class="hljs-name">disallowing-recur</span>
                        (<span class="hljs-name">disallowing-ns*</span>
                          (<span class="hljs-name">analyze</span> (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span> env <span class="hljs-symbol">:context</span> <span class="hljs-symbol">:expr</span>) (<span class="hljs-symbol">:init</span> args) sym))))
          fn-var? (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name">some?</span> init-expr) (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> (<span class="hljs-symbol">:op</span> init-expr) <span class="hljs-symbol">:fn</span>))
          tag (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> fn-var?
                (<span class="hljs-name"><span class="hljs-builtin-name">or</span></span> (<span class="hljs-symbol">:ret-tag</span> init-expr) tag)
                (<span class="hljs-name"><span class="hljs-builtin-name">or</span></span> tag (<span class="hljs-symbol">:tag</span> init-expr)))
          export-as (<span class="hljs-name"><span class="hljs-builtin-name">when-let</span></span> [export-val (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:export</span>)]
                      (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> <span class="hljs-literal">true</span> export-val) var-name export-val))
          doc (<span class="hljs-name"><span class="hljs-builtin-name">or</span></span> (<span class="hljs-symbol">:doc</span> args) (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:doc</span>))]
      (<span class="hljs-name">when-some</span> [v (<span class="hljs-name"><span class="hljs-builtin-name">get-in</span></span> @env/*compiler* [:<span class="hljs-symbol">:namespaces</span> ns-name <span class="hljs-symbol">:defs</span> sym])]
        (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:declared</span>))
                   (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">true?</span></span> (<span class="hljs-symbol">:fn-var</span> v)) (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> fn-var?)))
          (<span class="hljs-name">warning</span> <span class="hljs-symbol">:fn-var</span> env {<span class="hljs-symbol">:ns-name</span> ns-name <span class="hljs-symbol">:sym</span> sym})))
      (<span class="hljs-name"><span class="hljs-builtin-name">swap!</span></span> env/*compiler* assoc-in [:<span class="hljs-symbol">:namespaces</span> ns-name <span class="hljs-symbol">:defs</span> sym]
        (<span class="hljs-name"><span class="hljs-builtin-name">merge</span></span>
          {<span class="hljs-symbol">:name</span> var-name}
          <span class="hljs-comment">;; remove actual test metadata, as it includes non-valid EDN and</span>
          <span class="hljs-comment">;; cannot be present in analysis cached to disk - David</span>
          (<span class="hljs-name">cond-&gt;</span> sym-meta
            (<span class="hljs-symbol">:test</span> sym-meta) (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span> <span class="hljs-symbol">:test</span> <span class="hljs-literal">true</span>))
          {<span class="hljs-symbol">:meta</span> (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym-meta
                   (<span class="hljs-name"><span class="hljs-builtin-name">dissoc</span></span> <span class="hljs-symbol">:test</span>)
                   (<span class="hljs-name"><span class="hljs-builtin-name">update-in</span></span> [<span class="hljs-symbol">:file</span>]
                     (<span class="hljs-name"><span class="hljs-builtin-name">fn</span></span> [f]
                       (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">=</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> env <span class="hljs-symbol">:ns</span> <span class="hljs-symbol">:name</span>) 'cljs.core)
                         <span class="hljs-string">"cljs/core.cljs"</span>
                         f))))}
          (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> doc {<span class="hljs-symbol">:doc</span> doc})
          (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">true?</span></span> dynamic) {<span class="hljs-symbol">:dynamic</span> <span class="hljs-literal">true</span>})
          (<span class="hljs-name">source-info</span> var-name env)
          <span class="hljs-comment">;; the protocol a protocol fn belongs to</span>
          (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> protocol
            {<span class="hljs-symbol">:protocol</span> protocol})
          <span class="hljs-comment">;; symbol for reified protocol</span>
          (<span class="hljs-name"><span class="hljs-builtin-name">when-let</span></span> [protocol-symbol (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> sym meta <span class="hljs-symbol">:protocol-symbol</span>)]
            {<span class="hljs-symbol">:protocol-symbol</span> protocol-symbol
             <span class="hljs-symbol">:info</span> (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> protocol-symbol meta <span class="hljs-symbol">:protocol-info</span>)
             <span class="hljs-symbol">:impls</span> #{}})
          (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> fn-var?
            (<span class="hljs-name"><span class="hljs-builtin-name">let</span></span> [params (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> #(<span class="hljs-name"><span class="hljs-builtin-name">vec</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> <span class="hljs-symbol">:name</span> (<span class="hljs-symbol">:params</span> %))) (<span class="hljs-symbol">:methods</span> init-expr))]
              (<span class="hljs-name"><span class="hljs-builtin-name">merge</span></span>
                {<span class="hljs-symbol">:fn-var</span> (<span class="hljs-name"><span class="hljs-builtin-name">not</span></span> (<span class="hljs-symbol">:macro</span> sym-meta))
                 <span class="hljs-comment">;; protocol implementation context</span>
                 <span class="hljs-symbol">:protocol-impl</span> (<span class="hljs-symbol">:protocol-impl</span> init-expr)
                 <span class="hljs-comment">;; inline protocol implementation context</span>
                 <span class="hljs-symbol">:protocol-inline</span> (<span class="hljs-symbol">:protocol-inline</span> init-expr)}
                (<span class="hljs-name">if-some</span> [top-fn-meta (<span class="hljs-symbol">:top-fn</span> sym-meta)]
                  top-fn-meta
                  {<span class="hljs-symbol">:variadic</span> (<span class="hljs-symbol">:variadic</span> init-expr)
                   <span class="hljs-symbol">:max-fixed-arity</span> (<span class="hljs-symbol">:max-fixed-arity</span> init-expr)
                   <span class="hljs-symbol">:method-params</span> params
                   <span class="hljs-symbol">:arglists</span> (<span class="hljs-symbol">:arglists</span> sym-meta)
                   <span class="hljs-symbol">:arglists-meta</span> (<span class="hljs-name"><span class="hljs-builtin-name">doall</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">map</span></span> meta (<span class="hljs-symbol">:arglists</span> sym-meta)))}))))
          (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">and</span></span> fn-var? (<span class="hljs-name">some?</span> tag))
            {<span class="hljs-symbol">:ret-tag</span> tag}
            (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> tag {<span class="hljs-symbol">:tag</span> tag}))))
      (<span class="hljs-name"><span class="hljs-builtin-name">merge</span></span>
        {<span class="hljs-symbol">:env</span> env
         <span class="hljs-symbol">:op</span> <span class="hljs-symbol">:def</span>
         <span class="hljs-symbol">:form</span> form
         <span class="hljs-symbol">:name</span> var-name
         <span class="hljs-symbol">:var</span> (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span>
                (<span class="hljs-name">analyze</span>
                  (<span class="hljs-name"><span class="hljs-builtin-name">-&gt;</span></span> env (<span class="hljs-name"><span class="hljs-builtin-name">dissoc</span></span> <span class="hljs-symbol">:locals</span>)
                    (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span> <span class="hljs-symbol">:context</span> <span class="hljs-symbol">:expr</span>)
                    (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span> <span class="hljs-symbol">:def-var</span> <span class="hljs-literal">true</span>))
                  sym)
                <span class="hljs-symbol">:op</span> <span class="hljs-symbol">:var</span>)
         <span class="hljs-symbol">:doc</span> doc
         <span class="hljs-symbol">:jsdoc</span> (<span class="hljs-symbol">:jsdoc</span> sym-meta)
         <span class="hljs-symbol">:init</span> init-expr}
        (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">true?</span></span> (<span class="hljs-symbol">:def-emits-var</span> env))
          {<span class="hljs-symbol">:var-ast</span> (<span class="hljs-name">var-ast</span> env sym)})
        (<span class="hljs-name">when-some</span> [test (<span class="hljs-symbol">:test</span> sym-meta)]
          {<span class="hljs-symbol">:test</span> (<span class="hljs-name">analyze</span> (<span class="hljs-name"><span class="hljs-builtin-name">assoc</span></span> env <span class="hljs-symbol">:context</span> <span class="hljs-symbol">:expr</span>) test)})
        (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name">some?</span> tag)
          (<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> fn-var?
            {<span class="hljs-symbol">:ret-tag</span> tag}
            {<span class="hljs-symbol">:tag</span> tag}))
        (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name"><span class="hljs-builtin-name">true?</span></span> dynamic) {<span class="hljs-symbol">:dynamic</span> <span class="hljs-literal">true</span>})
        (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name">some?</span> export-as) {<span class="hljs-symbol">:export</span> export-as})
        (<span class="hljs-name"><span class="hljs-builtin-name">when</span></span> (<span class="hljs-name">some?</span> init-expr) {<span class="hljs-symbol">:children</span> [init-expr]})))))</code></pre><hr /><div><a href="https://github.com/cljs/api/blob/master/docfiles/cljs.core/def.md">Edit Here!</a></div></div><footer class="site-footer"><div class="wrapper"><hr /><div class="cljs-legal">ClojureScript is licensed <a href="http://opensource.org/licenses/eclipse-1.0.php">EPL 1.0</a><br />Copyright Â© Rich Hickey</div></div></footer></div></body></html>