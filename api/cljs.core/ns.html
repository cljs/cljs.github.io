<html><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>ns</title><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" /><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" /><link href="/css/normalize.css" rel="stylesheet" /><link href="/css/skeleton.css" rel="stylesheet" /><link href="/css/custom.css" rel="stylesheet" /><link href="/css/github-theme.css" rel="stylesheet" /><link href="/img/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57" /><link href="/img/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114" /><link href="/img/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72" /><link href="/img/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144" /><link href="/img/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60" /><link href="/img/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" /><link href="/img/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" /><link href="/img/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" /><link href="/img/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" /><link href="/img/icons/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png" /><link href="/img/icons/favicon-160x160.png" rel="icon" sizes="160x160" type="image/png" /><link href="/img/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png" /><link href="/img/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="/img/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /></head><body><div class="container"><nav class="navbar"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link-logo"><img class="navbar-logo" src="/img/cljs-white.svg" /></a></li><li class="navbar-item"><a class="navbar-title">ClojureScript</a></li><li class="navbar-item"><a class="navbar-link" href="/api">API</a></li><li class="navbar-item"><a class="navbar-link" href="https://github.com/clojure/clojurescript" target="_blank">GitHub</a></li></ul></div></nav><div><h1 class="y">ns</h1><table><tr><td>special form</td><td>since v0.0-927</td><td><a href="http://clojure.github.io/clojure/branch-master/clojure.core-api.html#clojure.core/ns"><img height="24px" src="/img/clojure-icon.gif" valign="middle" /> clojure.core/ns</a></td><td><a href="https://github.com/cljs/api/blob/master/docfiles/cljs.core/ns.md">Edit</a></td></tr></table><div><code>(ns name docstring? attr-map? references*)</code></div><hr /><h3>Details:</h3><div><p>Sets the namespace of the file.</p>
<p><code>ns</code> must be the first form in a <code>.cljs</code> file and there can only be one <code>ns</code>
declaration per file. Namespaces must match the file name of their respective
<code>.cljs</code> files, with the exception that dashes in namespaces become underscores
in filenames. Thus, <code>(ns foo.bar-biz.baz)</code> should be the first form in file
<code>foo/bar_biz/baz.cljs</code>.</p>
<p><code>references</code> can be zero or more forms used to import other namespaces, symbols,
and libraries into the current namespace.</p>
<pre><code class="syntax"><span class="s-exp">(</span><span class="macro">ns</span> <span class="symbol">example.core</span>

  <span class="comment">;; for excluding or renaming clojure symbols
</span>  <span class="s-exp">(</span><span class="keyword">:refer-clojure</span>
    <span class="keyword">:exclude</span> <span class="s-exp">[</span><span class="s-exp">]</span>
    <span class="keyword">:rename</span> <span class="s-exp">{</span><span class="s-exp">}</span><span class="s-exp">)</span>

  <span class="comment">;; for importing goog classes and enums
</span>  <span class="s-exp">(</span><span class="keyword">:import</span>
    <span class="symbol">lib.ns</span>
    <span class="s-exp">(</span><span class="symbol">lib.ns</span> <span class="symbol">Ctor*</span><span class="s-exp">)</span><span class="s-exp">)</span>

  <span class="s-exp">(</span><span class="keyword">:require</span>
    <span class="symbol">lib.ns</span>
    <span class="s-exp">[</span><span class="symbol">lib.ns</span> <span class="keyword">:refer</span> <span class="s-exp">[</span><span class="s-exp">]</span>
            <span class="keyword">:refer-macros</span> <span class="s-exp">[</span><span class="s-exp">]</span>
            <span class="keyword">:rename</span> <span class="s-exp">{</span><span class="s-exp">}</span>
            <span class="keyword">:include-macros</span> <span class="symbol">true|false</span>
            <span class="keyword">:as</span> <span class="core-fn">alias</span><span class="s-exp">]</span>
    <span class="keyword">:reload</span>
    <span class="keyword">:reload-all</span><span class="s-exp">)</span>

  <span class="s-exp">(</span><span class="keyword">:use</span>
    <span class="symbol">lib.ns</span>
    <span class="s-exp">[</span><span class="symbol">lib.ns</span> <span class="keyword">:only</span> <span class="s-exp">[</span><span class="s-exp">]</span>
            <span class="keyword">:rename</span> <span class="s-exp">{</span><span class="s-exp">}</span><span class="s-exp">]</span>
    <span class="keyword">:reload</span>
    <span class="keyword">:reload-all</span><span class="s-exp">)</span>

  <span class="s-exp">(</span><span class="keyword">:require-macros</span>
    <span class="symbol">lib.ns</span>
    <span class="s-exp">[</span><span class="symbol">lib.ns</span> <span class="keyword">:refer</span> <span class="s-exp">[</span><span class="s-exp">]</span>
            <span class="keyword">:rename</span> <span class="s-exp">{</span><span class="s-exp">}</span>
            <span class="keyword">:as</span> <span class="core-fn">alias</span><span class="s-exp">]</span>
    <span class="keyword">:reload</span>
    <span class="keyword">:reload-all</span><span class="s-exp">)</span>

  <span class="s-exp">(</span><span class="keyword">:use-macros</span>
    <span class="symbol">lib.ns</span>
    <span class="s-exp">[</span><span class="symbol">lib.ns</span> <span class="keyword">:only</span> <span class="s-exp">[</span><span class="s-exp">]</span>
            <span class="keyword">:rename</span> <span class="s-exp">{</span><span class="s-exp">}</span><span class="s-exp">]</span>
    <span class="keyword">:reload</span>
    <span class="keyword">:reload-all</span><span class="s-exp">)</span><span class="s-exp">)</span>
</code></pre>
</div><hr /><h3>See Also:</h3><ul><li><a href="/api/cljs.core/in-ns">in-ns (repl)</a></li><li><a href="/api/cljs.core/load-namespace">load-namespace (repl)</a></li><li><a href="/api/cljs.core/import">import</a></li><li><a href="/api/cljs.core/require">require</a></li><li><a href="/api/cljs.core/require-macros">require-macros</a></li></ul><hr />Source docstring:<pre>You must currently use the ns form only with the following caveats

  * You must use the :only form of :use
  * :require supports :as, :refer, and :rename
    - all options can be skipped
    - in this case a symbol can be used as a libspec directly
      - that is, (:require lib.foo) and (:require [lib.foo]) are both
        supported and mean the same thing
    - :rename specifies a map from referred var names to different
      symbols (and can be used to prevent clashes)
    - prefix lists are not supported
  * The only options for :refer-clojure are :exclude and :rename
  * :import is available for importing Google Closure classes
    - ClojureScript types and records should be brought in with :use
      or :require :refer, not :import ed
  * Macros must be defined in a different compilation stage than the one
    from where they are consumed. One way to achieve this is to define
    them in one namespace and use them from another. They are referenced
    via the :require-macros / :use-macros options to ns
    - :require-macros and :use-macros support the same forms that
      :require and :use do

Implicit macro loading: If a namespace is required or used, and that
namespace itself requires or uses macros from its own namespace, then
the macros will be implicitly required or used using the same
specifications. Furthermore, in this case, macro vars may be included
in a :refer or :only spec. This oftentimes leads to simplified library
usage, such that the consuming namespace need not be concerned about
explicitly distinguishing between whether certain vars are functions
or macros. For example:

(ns testme.core (:require [cljs.test :as test :refer [test-var deftest]]))

will result in test/is resolving properly, along with the test-var
function and the deftest macro being available unqualified.

Inline macro specification: As a convenience, :require can be given
either :include-macros true or :refer-macros [syms...]. Both desugar
into forms which explicitly load the matching Clojure file containing
macros. (This works independently of whether the namespace being
required internally requires or uses its own macros.) For example:

(ns testme.core
(:require [foo.core :as foo :refer [foo-fn] :include-macros true]
          [woz.core :as woz :refer [woz-fn] :refer-macros [app jx]]))

is sugar for

(ns testme.core
(:require [foo.core :as foo :refer [foo-fn]]
          [woz.core :as woz :refer [woz-fn]])
(:require-macros [foo.core :as foo]
                 [woz.core :as woz :refer [app jx]]))

Auto-aliasing clojure namespaces: If a non-existing clojure.* namespace
is required or used and a matching cljs.* namespace exists, the cljs.*
namespace will be loaded and an alias will be automatically established
from the clojure.* namespace to the cljs.* namespace. For example:

(ns testme.core (:require [clojure.test]))

will be automatically converted to

(ns testme.core (:require [cljs.test :as clojure.test]))</pre><div>Parser code @ <a href="https://github.com/clojure/clojurescript/blob/r1.11.60/src/main/clojure/cljs/analyzer.cljc#L3207-L3316">clojurescript:src/main/clojure/cljs/analyzer.cljc</a></div><pre><code class="syntax"><span class="s-exp">(</span><span class="definition">defmethod</span> <span class="symbol">parse</span> <span class="reader-char">'</span><span class="macro">ns</span>
  <span class="s-exp">[</span><span class="symbol">_</span> <span class="symbol">env</span> <span class="s-exp">[</span><span class="symbol">_</span> <span class="core-fn">name</span> <span class="reader-char">&</span> <span class="symbol">args</span> <span class="keyword">:as</span> <span class="symbol">form</span><span class="s-exp">]</span> <span class="symbol">_</span> <span class="symbol">opts</span><span class="s-exp">]</span>
  <span class="s-exp">(</span><span class="conditional">when-not</span> <span class="symbol">*allow-ns*</span>
    <span class="s-exp">(</span><span class="exception">throw</span> <span class="s-exp">(</span><span class="symbol">error</span> <span class="symbol">env</span> <span class="string">"Namespace declarations must appear at the top-level."</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
  <span class="s-exp">(</span><span class="conditional">when-not</span> <span class="s-exp">(</span><span class="core-fn">symbol?</span> <span class="core-fn">name</span><span class="s-exp">)</span>
    <span class="s-exp">(</span><span class="exception">throw</span> <span class="s-exp">(</span><span class="symbol">error</span> <span class="symbol">env</span> <span class="string">"Namespaces must be named by a symbol."</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
  <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="core-fn">name</span> <span class="s-exp">(</span><span class="conditional">cond-></span> <span class="core-fn">name</span> <span class="s-exp">(</span><span class="keyword">:macros-ns</span> <span class="symbol">opts</span><span class="s-exp">)</span> <span class="symbol">macro-ns-name</span><span class="s-exp">)</span><span class="s-exp">]</span>
    <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="symbol">segments</span> <span class="s-exp">(</span><span class="symbol">string/split</span> <span class="s-exp">(</span><span class="core-fn">clojure.core/name</span> <span class="core-fn">name</span><span class="s-exp">)</span> <span class="regex">#"\."</span><span class="s-exp">)</span><span class="s-exp">]</span>
      <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">=</span> <span class="number">1</span> <span class="s-exp">(</span><span class="core-fn">count</span> <span class="symbol">segments</span><span class="s-exp">)</span><span class="s-exp">)</span>
        <span class="s-exp">(</span><span class="symbol">warning</span> <span class="keyword">:single-segment-namespace</span> <span class="symbol">env</span> <span class="s-exp">{</span><span class="keyword">:name</span> <span class="core-fn">name</span><span class="s-exp">}</span><span class="s-exp">)</span><span class="s-exp">)</span>
      <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="symbol">segment</span> <span class="s-exp">(</span><span class="core-fn">some</span> <span class="symbol">js-reserved</span> <span class="symbol">segments</span><span class="s-exp">)</span><span class="s-exp">]</span>
        <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">some?</span> <span class="symbol">segment</span><span class="s-exp">)</span>
          <span class="s-exp">(</span><span class="symbol">warning</span> <span class="keyword">:munged-namespace</span> <span class="symbol">env</span> <span class="s-exp">{</span><span class="keyword">:name</span> <span class="core-fn">name</span><span class="s-exp">}</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
      <span class="s-exp">(</span><span class="symbol">find-def-clash</span> <span class="symbol">env</span> <span class="core-fn">name</span> <span class="symbol">segments</span><span class="s-exp">)</span>
      <span class="reader-char">#</span><span class="symbol">?</span><span class="s-exp">(</span><span class="keyword">:clj</span>
         <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">some</span> <span class="s-exp">(</span><span class="core-fn">complement</span> <span class="symbol">util/valid-js-id-start?</span><span class="s-exp">)</span> <span class="symbol">segments</span><span class="s-exp">)</span>
           <span class="s-exp">(</span><span class="exception">throw</span>
             <span class="s-exp">(</span><span class="symbol">AssertionError.</span>
               <span class="s-exp">(</span><span class="core-fn">str</span> <span class="string">"Namespace "</span> <span class="core-fn">name</span> <span class="string">" has a segment starting with an invaild "</span>
                    <span class="string">"JavaScript identifier"</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
    <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="symbol">docstring</span>    <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">string?</span> <span class="s-exp">(</span><span class="core-fn">first</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">first</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span>
          <span class="symbol">mdocstr</span>      <span class="s-exp">(</span><span class="macro">-></span> <span class="core-fn">name</span> <span class="core-fn">meta</span> <span class="keyword">:doc</span><span class="s-exp">)</span>
          <span class="symbol">args</span>         <span class="s-exp">(</span><span class="special-form">if</span> <span class="s-exp">(</span><span class="core-fn">some?</span> <span class="symbol">docstring</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">next</span> <span class="symbol">args</span><span class="s-exp">)</span> <span class="symbol">args</span><span class="s-exp">)</span>
          <span class="symbol">metadata</span>     <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">map?</span> <span class="s-exp">(</span><span class="core-fn">first</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">first</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span>
          <span class="symbol">args</span>         <span class="s-exp">(</span><span class="symbol">desugar-ns-specs</span>
                         <span class="reader-char">#</span><span class="symbol">?</span><span class="s-exp">(</span><span class="keyword">:clj</span>  <span class="s-exp">(</span><span class="symbol">rewrite-cljs-aliases</span>
                                    <span class="s-exp">(</span><span class="special-form">if</span> <span class="symbol">metadata</span> <span class="s-exp">(</span><span class="core-fn">next</span> <span class="symbol">args</span><span class="s-exp">)</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span>
                            <span class="keyword">:cljs</span> <span class="s-exp">(</span><span class="special-form">if</span> <span class="s-exp">(</span><span class="core-fn">some?</span> <span class="symbol">metadata</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">next</span> <span class="symbol">args</span><span class="s-exp">)</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
          <span class="s-exp">{</span><span class="keyword">:keys</span> <span class="s-exp">[</span><span class="symbol">as-aliases</span><span class="s-exp">]</span> <span class="symbol">args</span> <span class="keyword">:libspecs</span><span class="s-exp">}</span> <span class="s-exp">(</span><span class="symbol">nses/elide-aliases-from-ns-specs</span> <span class="symbol">args</span><span class="s-exp">)</span>
          <span class="core-fn">name</span>         <span class="s-exp">(</span><span class="core-fn">vary-meta</span> <span class="core-fn">name</span> <span class="core-fn">merge</span> <span class="symbol">metadata</span><span class="s-exp">)</span>
          <span class="s-exp">{</span><span class="symbol">excludes</span> <span class="keyword">:excludes</span> <span class="symbol">core-renames</span> <span class="keyword">:renames</span><span class="s-exp">}</span> <span class="s-exp">(</span><span class="symbol">parse-ns-excludes</span> <span class="symbol">env</span> <span class="symbol">args</span><span class="s-exp">)</span>
          <span class="symbol">core-renames</span> <span class="s-exp">(</span><span class="core-fn">reduce</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">m</span> <span class="s-exp">[</span><span class="symbol">original</span> <span class="symbol">renamed</span><span class="s-exp">]</span><span class="s-exp">]</span>
                                 <span class="s-exp">(</span><span class="core-fn">assoc</span> <span class="symbol">m</span> <span class="symbol">renamed</span> <span class="s-exp">(</span><span class="core-fn">symbol</span> <span class="string">"cljs.core"</span> <span class="s-exp">(</span><span class="core-fn">str</span> <span class="symbol">original</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
                         <span class="s-exp">{</span><span class="s-exp">}</span> <span class="symbol">core-renames</span><span class="s-exp">)</span>
          <span class="symbol">deps</span>         <span class="s-exp">(</span><span class="core-fn">atom</span> <span class="s-exp">[</span><span class="s-exp">]</span><span class="s-exp">)</span>
          <span class="comment">;; as-aliases can only be used *once* because they are about the reader
</span>          <span class="symbol">aliases</span>      <span class="s-exp">(</span><span class="core-fn">atom</span> <span class="s-exp">{</span><span class="keyword">:fns</span> <span class="symbol">as-aliases</span> <span class="keyword">:macros</span> <span class="symbol">as-aliases</span><span class="s-exp">}</span><span class="s-exp">)</span>
          <span class="symbol">spec-parsers</span> <span class="s-exp">{</span><span class="keyword">:require</span>        <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">parse-require-spec</span> <span class="symbol">env</span> <span class="boolean">false</span> <span class="symbol">deps</span> <span class="symbol">aliases</span><span class="s-exp">)</span>
                        <span class="keyword">:require-macros</span> <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">parse-require-spec</span> <span class="symbol">env</span> <span class="boolean">true</span> <span class="symbol">deps</span> <span class="symbol">aliases</span><span class="s-exp">)</span>
                        <span class="keyword">:use</span>            <span class="s-exp">(</span><span class="core-fn">comp</span> <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">parse-require-spec</span> <span class="symbol">env</span> <span class="boolean">false</span> <span class="symbol">deps</span> <span class="symbol">aliases</span><span class="s-exp">)</span>
                                          <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">use->require</span> <span class="symbol">env</span><span class="s-exp">)</span><span class="s-exp">)</span>
                        <span class="keyword">:use-macros</span>     <span class="s-exp">(</span><span class="core-fn">comp</span> <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">parse-require-spec</span> <span class="symbol">env</span> <span class="boolean">true</span> <span class="symbol">deps</span> <span class="symbol">aliases</span><span class="s-exp">)</span>
                                          <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">use->require</span> <span class="symbol">env</span><span class="s-exp">)</span><span class="s-exp">)</span>
                        <span class="keyword">:import</span>         <span class="s-exp">(</span><span class="core-fn">partial</span> <span class="symbol">parse-import-spec</span> <span class="symbol">env</span> <span class="symbol">deps</span><span class="s-exp">)</span><span class="s-exp">}</span>
          <span class="symbol">valid-forms</span>  <span class="s-exp">(</span><span class="core-fn">atom</span> <span class="s-exp">#{</span><span class="keyword">:use</span> <span class="keyword">:use-macros</span> <span class="keyword">:require</span> <span class="keyword">:require-macros</span> <span class="keyword">:import</span><span class="s-exp">}</span><span class="s-exp">)</span>
          <span class="symbol">reload</span>       <span class="s-exp">(</span><span class="core-fn">atom</span> <span class="s-exp">{</span><span class="keyword">:use</span> <span class="nil">nil</span> <span class="keyword">:require</span> <span class="nil">nil</span> <span class="keyword">:use-macros</span> <span class="nil">nil</span> <span class="keyword">:require-macros</span> <span class="nil">nil</span><span class="s-exp">}</span><span class="s-exp">)</span>
          <span class="symbol">reloads</span>      <span class="s-exp">(</span><span class="core-fn">atom</span> <span class="s-exp">{</span><span class="s-exp">}</span><span class="s-exp">)</span>
          <span class="s-exp">{</span><span class="symbol">uses</span> <span class="keyword">:use</span> <span class="symbol">requires</span> <span class="keyword">:require</span> <span class="symbol">renames</span> <span class="keyword">:rename</span>
           <span class="symbol">use-macros</span> <span class="keyword">:use-macros</span> <span class="symbol">require-macros</span> <span class="keyword">:require-macros</span>
           <span class="symbol">rename-macros</span> <span class="keyword">:rename-macros</span> <span class="symbol">imports</span> <span class="keyword">:import</span> <span class="keyword">:as</span> <span class="symbol">params</span><span class="s-exp">}</span>
          <span class="s-exp">(</span><span class="core-fn">reduce</span>
            <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">m</span> <span class="s-exp">[</span><span class="symbol">k</span> <span class="reader-char">&</span> <span class="symbol">libs</span> <span class="keyword">:as</span> <span class="symbol">libspec</span><span class="s-exp">]</span><span class="s-exp">]</span>
              <span class="s-exp">(</span><span class="conditional">when-not</span> <span class="s-exp">(</span><span class="s-exp">#{</span><span class="keyword">:use</span> <span class="keyword">:use-macros</span> <span class="keyword">:require</span> <span class="keyword">:require-macros</span> <span class="keyword">:import</span><span class="s-exp">}</span> <span class="symbol">k</span><span class="s-exp">)</span>
                <span class="s-exp">(</span><span class="exception">throw</span> <span class="s-exp">(</span><span class="symbol">error</span> <span class="symbol">env</span> <span class="s-exp">(</span><span class="core-fn">str</span> <span class="string">"Only :refer-clojure, :require, :require-macros, :use, :use-macros, and :import libspecs supported. Got "</span> <span class="symbol">libspec</span> <span class="string">" instead."</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
              <span class="s-exp">(</span><span class="conditional">when-not</span> <span class="s-exp">(</span><span class="reader-char">@</span><span class="symbol">valid-forms</span> <span class="symbol">k</span><span class="s-exp">)</span>
                <span class="s-exp">(</span><span class="exception">throw</span> <span class="s-exp">(</span><span class="symbol">error</span> <span class="symbol">env</span> <span class="s-exp">(</span><span class="core-fn">str</span> <span class="string">"Only one "</span> <span class="symbol">k</span> <span class="string">" form is allowed per namespace definition"</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
              <span class="s-exp">(</span><span class="core-fn">swap!</span> <span class="symbol">valid-forms</span> <span class="core-fn">disj</span> <span class="symbol">k</span><span class="s-exp">)</span>
              <span class="comment">;; check for spec type reloads
</span>              <span class="s-exp">(</span><span class="conditional">when-not</span> <span class="s-exp">(</span><span class="core-fn">=</span> <span class="keyword">:import</span> <span class="symbol">k</span><span class="s-exp">)</span>
                <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">some?</span> <span class="s-exp">(</span><span class="core-fn">some</span> <span class="s-exp">#{</span><span class="keyword">:reload</span><span class="s-exp">}</span> <span class="symbol">libs</span><span class="s-exp">)</span><span class="s-exp">)</span>
                  <span class="s-exp">(</span><span class="core-fn">swap!</span> <span class="symbol">reload</span> <span class="core-fn">assoc</span> <span class="symbol">k</span> <span class="keyword">:reload</span><span class="s-exp">)</span><span class="s-exp">)</span>
                <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="core-fn">some?</span> <span class="s-exp">(</span><span class="core-fn">some</span> <span class="s-exp">#{</span><span class="keyword">:reload-all</span><span class="s-exp">}</span> <span class="symbol">libs</span><span class="s-exp">)</span><span class="s-exp">)</span>
                  <span class="s-exp">(</span><span class="core-fn">swap!</span> <span class="symbol">reload</span> <span class="core-fn">assoc</span> <span class="symbol">k</span> <span class="keyword">:reload-all</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
              <span class="comment">;; check for individual ns reloads from REPL interactions
</span>              <span class="s-exp">(</span><span class="conditional">when-let</span> <span class="s-exp">[</span><span class="symbol">xs</span> <span class="s-exp">(</span><span class="core-fn">seq</span> <span class="s-exp">(</span><span class="core-fn">filter</span> <span class="reader-char">#</span><span class="s-exp">(</span><span class="macro">-></span> <span class="keyword">%</span> <span class="core-fn">meta</span> <span class="keyword">:reload</span><span class="s-exp">)</span> <span class="symbol">libs</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">]</span>
                <span class="s-exp">(</span><span class="core-fn">swap!</span> <span class="symbol">reloads</span> <span class="core-fn">assoc</span> <span class="symbol">k</span>
                  <span class="s-exp">(</span><span class="core-fn">zipmap</span> <span class="s-exp">(</span><span class="core-fn">map</span> <span class="core-fn">first</span> <span class="symbol">xs</span><span class="s-exp">)</span> <span class="s-exp">(</span><span class="core-fn">map</span> <span class="reader-char">#</span><span class="s-exp">(</span><span class="macro">-></span> <span class="keyword">%</span> <span class="core-fn">meta</span> <span class="keyword">:reload</span><span class="s-exp">)</span> <span class="symbol">xs</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
              <span class="s-exp">(</span><span class="core-fn">apply</span> <span class="core-fn">merge-with</span> <span class="core-fn">merge</span> <span class="symbol">m</span>
                <span class="s-exp">(</span><span class="core-fn">map</span> <span class="s-exp">(</span><span class="symbol">spec-parsers</span> <span class="symbol">k</span><span class="s-exp">)</span>
                  <span class="s-exp">(</span><span class="core-fn">remove</span> <span class="s-exp">#{</span><span class="keyword">:reload</span> <span class="keyword">:reload-all</span><span class="s-exp">}</span> <span class="symbol">libs</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
            <span class="s-exp">{</span><span class="s-exp">}</span> <span class="s-exp">(</span><span class="core-fn">remove</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="s-exp">[</span><span class="symbol">r</span><span class="s-exp">]</span><span class="s-exp">]</span> <span class="s-exp">(</span><span class="core-fn">=</span> <span class="symbol">r</span> <span class="keyword">:refer-clojure</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="symbol">args</span><span class="s-exp">)</span><span class="s-exp">)</span>
          <span class="comment">;; patch `require-macros` and `use-macros` in Bootstrap for namespaces
</span>          <span class="comment">;; that require their own macros
</span>          <span class="reader-char">#</span><span class="symbol">?</span><span class="reader-char">@</span><span class="s-exp">(</span><span class="keyword">:cljs</span> <span class="s-exp">[</span><span class="s-exp">[</span><span class="symbol">require-macros</span> <span class="symbol">use-macros</span><span class="s-exp">]</span>
                     <span class="s-exp">(</span><span class="core-fn">map</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">spec-map</span><span class="s-exp">]</span>
                            <span class="s-exp">(</span><span class="special-form">if</span> <span class="s-exp">(</span><span class="keyword">:macros-ns</span> <span class="symbol">opts</span><span class="s-exp">)</span>
                              <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="macro">ns</span> <span class="s-exp">(</span><span class="core-fn">symbol</span> <span class="s-exp">(</span><span class="core-fn">subs</span> <span class="s-exp">(</span><span class="core-fn">str</span> <span class="core-fn">name</span><span class="s-exp">)</span> <span class="number">0</span> <span class="s-exp">(</span><span class="core-fn">-</span> <span class="s-exp">(</span><span class="core-fn">count</span> <span class="s-exp">(</span><span class="core-fn">str</span> <span class="core-fn">name</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="number">7</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">]</span>
                                <span class="s-exp">(</span><span class="core-fn">reduce</span> <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">m</span> <span class="s-exp">[</span><span class="symbol">k</span> <span class="symbol">v</span><span class="s-exp">]</span><span class="s-exp">]</span>
                                          <span class="s-exp">(</span><span class="conditional">cond-></span> <span class="symbol">m</span>
                                            <span class="s-exp">(</span><span class="core-fn">not</span> <span class="s-exp">(</span><span class="symbol">symbol-identical?</span> <span class="symbol">v</span> <span class="macro">ns</span><span class="s-exp">)</span><span class="s-exp">)</span>
                                            <span class="s-exp">(</span><span class="core-fn">assoc</span> <span class="symbol">k</span> <span class="symbol">v</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
                                  <span class="s-exp">{</span><span class="s-exp">}</span> <span class="symbol">spec-map</span><span class="s-exp">)</span><span class="s-exp">)</span>
                              <span class="symbol">spec-map</span><span class="s-exp">)</span><span class="s-exp">)</span> <span class="s-exp">[</span><span class="symbol">require-macros</span> <span class="symbol">use-macros</span><span class="s-exp">]</span><span class="s-exp">)</span><span class="s-exp">]</span><span class="s-exp">)</span><span class="s-exp">]</span>
      <span class="s-exp">(</span><span class="special-form">set!</span> <span class="symbol">*cljs-ns*</span> <span class="core-fn">name</span><span class="s-exp">)</span>
      <span class="s-exp">(</span><span class="special-form">let</span> <span class="s-exp">[</span><span class="symbol">ns-info</span>
            <span class="s-exp">{</span><span class="keyword">:as-aliases</span>     <span class="symbol">as-aliases</span>
             <span class="keyword">:name</span>           <span class="core-fn">name</span>
             <span class="keyword">:doc</span>            <span class="s-exp">(</span><span class="macro">or</span> <span class="symbol">docstring</span> <span class="symbol">mdocstr</span><span class="s-exp">)</span>
             <span class="keyword">:excludes</span>       <span class="symbol">excludes</span>
             <span class="keyword">:use-macros</span>     <span class="symbol">use-macros</span>
             <span class="keyword">:require-macros</span> <span class="symbol">require-macros</span>
             <span class="keyword">:rename-macros</span>  <span class="symbol">rename-macros</span>
             <span class="keyword">:uses</span>           <span class="symbol">uses</span>
             <span class="keyword">:requires</span>       <span class="symbol">requires</span>
             <span class="keyword">:renames</span>        <span class="s-exp">(</span><span class="core-fn">merge</span> <span class="symbol">renames</span> <span class="symbol">core-renames</span><span class="s-exp">)</span>
             <span class="keyword">:imports</span>        <span class="symbol">imports</span><span class="s-exp">}</span><span class="s-exp">]</span>
        <span class="s-exp">(</span><span class="core-fn">swap!</span> <span class="symbol">env/*compiler*</span> <span class="core-fn">update-in</span> <span class="s-exp">[</span><span class="keyword">::namespaces</span> <span class="core-fn">name</span><span class="s-exp">]</span> <span class="core-fn">merge</span> <span class="symbol">ns-info</span><span class="s-exp">)</span>
        <span class="s-exp">(</span><span class="core-fn">merge</span> <span class="s-exp">{</span><span class="keyword">:op</span>      <span class="keyword">:ns</span>
                <span class="keyword">:env</span>     <span class="symbol">env</span>
                <span class="keyword">:form</span>    <span class="symbol">form</span>
                <span class="keyword">:deps</span>    <span class="s-exp">(</span><span class="core-fn">into</span> <span class="s-exp">[</span><span class="s-exp">]</span> <span class="s-exp">(</span><span class="core-fn">distinct</span> <span class="reader-char">@</span><span class="symbol">deps</span><span class="s-exp">)</span><span class="s-exp">)</span>
                <span class="keyword">:reload</span>  <span class="reader-char">@</span><span class="symbol">reload</span>
                <span class="keyword">:reloads</span> <span class="reader-char">@</span><span class="symbol">reloads</span><span class="s-exp">}</span>
          <span class="s-exp">(</span><span class="conditional">cond-></span> <span class="symbol">ns-info</span>
            <span class="s-exp">(</span><span class="reader-char">@</span><span class="symbol">reload</span> <span class="keyword">:use</span><span class="s-exp">)</span>
            <span class="s-exp">(</span><span class="core-fn">update-in</span> <span class="s-exp">[</span><span class="keyword">:uses</span><span class="s-exp">]</span>
              <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">m</span><span class="s-exp">]</span> <span class="s-exp">(</span><span class="core-fn">with-meta</span> <span class="symbol">m</span> <span class="s-exp">{</span><span class="s-exp">(</span><span class="reader-char">@</span><span class="symbol">reload</span> <span class="keyword">:use</span><span class="s-exp">)</span> <span class="boolean">true</span><span class="s-exp">}</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
            <span class="s-exp">(</span><span class="reader-char">@</span><span class="symbol">reload</span> <span class="keyword">:require</span><span class="s-exp">)</span>
            <span class="s-exp">(</span><span class="core-fn">update-in</span> <span class="s-exp">[</span><span class="keyword">:requires</span><span class="s-exp">]</span>
              <span class="s-exp">(</span><span class="special-form">fn</span> <span class="s-exp">[</span><span class="symbol">m</span><span class="s-exp">]</span> <span class="s-exp">(</span><span class="core-fn">with-meta</span> <span class="symbol">m</span> <span class="s-exp">{</span><span class="s-exp">(</span><span class="reader-char">@</span><span class="symbol">reload</span> <span class="keyword">:require</span><span class="s-exp">)</span> <span class="boolean">true</span><span class="s-exp">}</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span></code></pre><hr /><div>Emitting code @ <a href="https://github.com/clojure/clojurescript/blob/r1.11.60/src/main/clojure/cljs/compiler.cljc#L1378-L1386">clojurescript:src/main/clojure/cljs/compiler.cljc</a></div><pre><code class="syntax"><span class="s-exp">(</span><span class="definition">defmethod</span> <span class="symbol">emit*</span> <span class="keyword">:ns</span>
  <span class="s-exp">[</span><span class="s-exp">{</span><span class="keyword">:keys</span> <span class="s-exp">[</span><span class="core-fn">name</span> <span class="symbol">requires</span> <span class="symbol">uses</span> <span class="symbol">require-macros</span> <span class="symbol">reloads</span> <span class="symbol">env</span> <span class="symbol">deps</span><span class="s-exp">]</span><span class="s-exp">}</span><span class="s-exp">]</span>
  <span class="s-exp">(</span><span class="symbol">emitln</span> <span class="string">"goog.provide('"</span> <span class="s-exp">(</span><span class="core-fn">munge</span> <span class="core-fn">name</span><span class="s-exp">)</span> <span class="string">"');"</span><span class="s-exp">)</span>
  <span class="s-exp">(</span><span class="conditional">when-not</span> <span class="s-exp">(</span><span class="core-fn">=</span> <span class="core-fn">name</span> <span class="reader-char">'</span><span class="symbol">cljs.core</span><span class="s-exp">)</span>
    <span class="s-exp">(</span><span class="symbol">emitln</span> <span class="string">"goog.require('cljs.core');"</span><span class="s-exp">)</span>
    <span class="s-exp">(</span><span class="conditional">when</span> <span class="s-exp">(</span><span class="macro">-></span> <span class="reader-char">@</span><span class="symbol">env/*compiler*</span> <span class="keyword">:options</span> <span class="keyword">:emit-constants</span><span class="s-exp">)</span>
      <span class="s-exp">(</span><span class="symbol">emitln</span> <span class="string">"goog.require('"</span> <span class="s-exp">(</span><span class="core-fn">munge</span> <span class="symbol">ana/constants-ns-sym</span><span class="s-exp">)</span> <span class="string">"');"</span><span class="s-exp">)</span><span class="s-exp">)</span><span class="s-exp">)</span>
  <span class="s-exp">(</span><span class="symbol">load-libs</span> <span class="symbol">requires</span> <span class="nil">nil</span> <span class="s-exp">(</span><span class="keyword">:require</span> <span class="symbol">reloads</span><span class="s-exp">)</span> <span class="symbol">deps</span> <span class="core-fn">name</span><span class="s-exp">)</span>
  <span class="s-exp">(</span><span class="symbol">load-libs</span> <span class="symbol">uses</span> <span class="symbol">requires</span> <span class="s-exp">(</span><span class="keyword">:use</span> <span class="symbol">reloads</span><span class="s-exp">)</span> <span class="symbol">deps</span> <span class="core-fn">name</span><span class="s-exp">)</span><span class="s-exp">)</span></code></pre><hr /></div><footer class="site-footer"><div class="wrapper"><hr /><div class="cljs-legal">ClojureScript is licensed <a href="http://opensource.org/licenses/eclipse-1.0.php">EPL 1.0</a><br />Copyright Â© Rich Hickey</div></div></footer></div><script src="/js/client.js"></script></body></html>