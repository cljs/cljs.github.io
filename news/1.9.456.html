<html><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1" name="viewport" /><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" /><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" /><link href="/css/normalize.css" rel="stylesheet" /><link href="/css/skeleton.css" rel="stylesheet" /><link href="/css/custom.css" rel="stylesheet" /><link href="/css/github-theme.css" rel="stylesheet" /><link href="/img/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57" /><link href="/img/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114" /><link href="/img/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72" /><link href="/img/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144" /><link href="/img/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60" /><link href="/img/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" /><link href="/img/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" /><link href="/img/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" /><link href="/img/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" /><link href="/img/icons/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png" /><link href="/img/icons/favicon-160x160.png" rel="icon" sizes="160x160" type="image/png" /><link href="/img/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png" /><link href="/img/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="/img/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /></head><body><div class="container"><nav class="navbar"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link-logo"><img class="navbar-logo" src="/img/cljs-white.svg" /></a></li><li class="navbar-item"><a class="navbar-title">ClojureScript</a></li><li class="navbar-item"><a class="navbar-link" href="/api">API</a></li><li class="navbar-item"><a class="navbar-link" href="/news">News</a></li><li class="navbar-item"><a class="navbar-link" href="https://github.com/clojure/clojurescript" target="_blank">GitHub</a></li></ul></div></nav><div class="container"><div class="row"><div class="three columns" style="overflow-x: hidden"><div class="news-sidebar"><div><a href="/versions">Version Details</a></div><div class="sep"></div><div><span class="version"><a href="/news/1.9.494">1.9.494</a></span></div><div><span class="version"><a href="/news/1.9.473">1.9.473</a></span></div><div class="active"><span class="version"><a href="/news/1.9.456">1.9.456</a></span></div><div><span class="version"><a href="/news/1.9.293">1.9.293</a></span></div><div><span class="version"><a href="/news/1.9.229">1.9.229</a></span></div><div><span class="version"><a href="/news/1.9.216">1.9.216</a></span></div><div><span class="version"><a href="/news/1.9.198">1.9.198</a></span></div><div><span class="version"><a href="/news/1.9.89">1.9.89</a></span></div><div><span class="version"><a href="/news/1.9.76">1.9.76</a></span></div><div><span class="version"><a href="/news/1.9.36">1.9.36</a></span></div><div><span class="version"><a href="/news/1.9.14">1.9.14</a></span></div><div><span class="version"><a href="/news/1.8.51">1.8.51</a></span></div><div><span class="version"><a href="/news/1.8.40">1.8.40</a></span></div><div><span class="version"><a href="/news/1.8.34">1.8.34</a></span></div><div><span class="version"><a href="/news/1.7.228">1.7.228</a></span></div><div><span class="version"><a href="/news/1.7.170">1.7.170</a></span></div><div><span class="version"><a href="/news/1.7.145">1.7.145</a></span></div><div><span class="version"><a href="/news/1.7.48">1.7.48</a></span></div><div><span class="version"><a href="/news/1.7.28">1.7.28</a></span></div><div><span class="version"><a href="/news/0.0-3308">0.0-3308</a></span></div><div><span class="version"><a href="/news/0.0-3255">0.0-3255</a></span></div><div><span class="version"><a href="/news/0.0-3211">0.0-3211</a></span></div><div><span class="version"><a href="/news/0.0-3196">0.0-3196</a></span></div><div><span class="version"><a href="/news/0.0-3126">0.0-3126</a></span></div><div><span class="version"><a href="/news/0.0-3115">0.0-3115</a></span></div><div><span class="version"><a href="/news/0.0-3058">0.0-3058</a></span></div><div><span class="version"><a href="/news/0.0-2913">0.0-2913</a></span></div><div><span class="version"><a href="/news/0.0-2843">0.0-2843</a></span></div><div><span class="version"><a href="/news/0.0-2814">0.0-2814</a></span></div><div><span class="version"><a href="/news/0.0-2755">0.0-2755</a></span></div><div><span class="version"><a href="/news/0.0-2740">0.0-2740</a></span></div><div><span class="version"><a href="/news/0.0-2719">0.0-2719</a></span></div><div><span class="version"><a href="/news/0.0-2644">0.0-2644</a></span></div><div><span class="version"><a href="/news/0.0-2505">0.0-2505</a></span></div><div><span class="version"><a href="/news/0.0-2496">0.0-2496</a></span></div><div><span class="version"><a href="/news/0.0-2411">0.0-2411</a></span></div><div><span class="version"><a href="/news/0.0-2371">0.0-2371</a></span></div><div><span class="version"><a href="/news/0.0-2356">0.0-2356</a></span></div><div><span class="version"><a href="/news/0.0-2341">0.0-2341</a></span></div><div><span class="version"><a href="/news/0.0-2322">0.0-2322</a></span></div><div><span class="version"><a href="/news/0.0-2311">0.0-2311</a></span></div><div><span class="version"><a href="/news/0.0-2301">0.0-2301</a></span></div><div><span class="version"><a href="/news/0.0-2280">0.0-2280</a></span></div><div><span class="version"><a href="/news/0.0-2277">0.0-2277</a></span></div><div><span class="version"><a href="/news/0.0-2268">0.0-2268</a></span></div><div><span class="version"><a href="/news/0.0-2261">0.0-2261</a></span></div><div><span class="version"><a href="/news/0.0-2234">0.0-2234</a></span></div><div><span class="version"><a href="/news/0.0-2227">0.0-2227</a></span></div><div><span class="version"><a href="/news/0.0-2202">0.0-2202</a></span></div><div><span class="version"><a href="/news/0.0-2199">0.0-2199</a></span></div><div><span class="version"><a href="/news/0.0-2197">0.0-2197</a></span></div><div><span class="version"><a href="/news/0.0-2173">0.0-2173</a></span></div><div><span class="version"><a href="/news/0.0-2156">0.0-2156</a></span></div><div><span class="version"><a href="/news/0.0-2138">0.0-2138</a></span></div><div><span class="version"><a href="/news/0.0-2134">0.0-2134</a></span></div><div><span class="version"><a href="/news/0.0-2127">0.0-2127</a></span></div><div><span class="version"><a href="/news/0.0-2120">0.0-2120</a></span></div><div><span class="version"><a href="/news/0.0-2067">0.0-2067</a></span></div><div><span class="version"><a href="/news/0.0-2060">0.0-2060</a></span></div><div><span class="version"><a href="/news/0.0-2030">0.0-2030</a></span></div><div><span class="version"><a href="/news/0.0-2024">0.0-2024</a></span></div><div><span class="version"><a href="/news/0.0-2014">0.0-2014</a></span></div><div><span class="version"><a href="/news/0.0-1978">0.0-1978</a></span></div><div><span class="version"><a href="/news/0.0-1934">0.0-1934</a></span></div><div><span class="version"><a href="/news/0.0-1933">0.0-1933</a></span></div><div><span class="version"><a href="/news/0.0-1913">0.0-1913</a></span></div><div><span class="version"><a href="/news/0.0-1909">0.0-1909</a></span></div><div><span class="version"><a href="/news/0.0-1885">0.0-1885</a></span></div><div><span class="version"><a href="/news/0.0-1877">0.0-1877</a></span></div><div><span class="version"><a href="/news/0.0-1859">0.0-1859</a></span></div><div><span class="version"><a href="/news/0.0-1847">0.0-1847</a></span></div><div><span class="version"><a href="/news/0.0-1798">0.0-1798</a></span></div><div><span class="version"><a href="/news/0.0-1586">0.0-1586</a></span></div><div><span class="version"><a href="/news/0.0-1535">0.0-1535</a></span></div><div><span class="version"><a href="/news/0.0-1513">0.0-1513</a></span></div><div><span class="version"><a href="/news/0.0-1503">0.0-1503</a></span></div><div><span class="version"><a href="/news/0.0-1443">0.0-1443</a></span></div><div><span class="version"><a href="/news/0.0-1236">0.0-1236</a></span></div><div><span class="version"><a href="/news/0.0-1211">0.0-1211</a></span></div><div><span class="version"><a href="/news/0.0-971">0.0-971</a></span></div><div><span class="version"><a href="/news/0.0-927">0.0-927</a></span></div></div></div><div class="nine columns"><div><h2>1.9.456 - Externs Inference & Comprehensive JS Modules Support</h2><p>Jan 27, 2017 by David Nolen <a href="https://groups.google.com/d/msg/clojurescript/wGJeG36GPTk/e9XCo3a2BgAJ">on Google Groups</a></p><article><p>This is a significant feature release.</p>
<p>The first new feature is externs inference. This should greatly ease
the integration of 3rd party JavaScript libraries incompatible
with Google Closure advanced compilation. By treating the externs
problem as a type-hinting one - we can automatically generate the
required externs for you. This new feature should be considered
of alpha quality and subject to change. Still, feedback is greatly
appreciated to help us better understand how to best deliver this
enhancement.</p>
<p>For details please look at the new guide:<br>
<a href="https://clojurescript.org/guides/externs">https://clojurescript.org/guides/externs</a></p>
<p>The second new feature is much more comprehensive support for
JavaScript modules. We now have a good story for integrating the
various kinds of JavaScript modules into a ClojureScript project
build without resorting to JavaScript build tools. This feature
even includes the consumption of modules directly from NPM.</p>
<p>There are far too many details to cover in this release announcement
so once again refer to the guide:<br>
<a href="https://clojurescript.org/guides/javascript-modules">https://clojurescript.org/guides/javascript-modules</a></p>
<p>Like externs inference this feature is alpha and subject to change.
Again feedback is critical to guiding this enhancement in the
right direction.</p>
<p>I&#39;d like to especially call out Maria Geller&#39;s Google Summer of Code work
here around these two major features. This work began almost 2 years
and it&#39;s nice to see the long term planning come together so well.</p>
<p>There are quite a few performancement enhancements in this release
related to compiler startup time as well as numerous fixes from
many members of the community.</p>
<p>Congratulations to everyone involved and happy hacking!</p>
<h3 id="enhancements">Enhancements</h3>
<ul>
<li>Enhanced JavaScript module support</li>
<li>Support Node resolution for CommonJS modules</li>
<li>Externs inference</li>
<li>Performance enhancements</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1835">CLJS-1835</a>: REPL load special fn</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1194">CLJS-1194</a>: Support for <code>data_readers.cljc</code></li>
</ul>
<h3 id="changes">Changes</h3>
<ul>
<li>expose :closure-module-roots option</li>
<li>bump Closure Compiler dep</li>
<li>Under Node.js don&#39;t need require entries in the goog.addDependency calls in cljs_deps.js</li>
<li>do not throw on circular dependencies between Google Closure JS libs</li>
<li>str macro should call str/1 function directly, added str benchmark</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1718">CLJS-1718</a>: Foreign lib files should be placed in a relative location</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1858">CLJS-1858</a>: Should allow <code>:cache-analysis true</code> and <code>cache-analysis-format nil</code></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1616">CLJS-1616</a>: Self-host: improve documentation for compile-str</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1643">CLJS-1643</a>: Emit more informative error when emitting a type which has no emit multimethod case</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1816">CLJS-1816</a>: Basic timing info in verbose output</li>
<li>add support for emitting inferred externs file</li>
<li>add cljs.analyzer/analyze-form-seq</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1666">CLJS-1666</a>: Flag to optionally disable transit analysis cache encoding</li>
<li>Provide more descriptive error message when invalid libspec detected</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1768">CLJS-1768</a>: cljs.spec perf tweaks</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1842">CLJS-1842</a>: Remove analyzer <code>:merge</code> hack for REPLs</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1839">CLJS-1839</a>: Relax the constraint that <code>new</code> and dot forms must be passed a symbol</li>
<li>default to :ecmascript3 if :language-out not specified for :es6 module</li>
<li>respect :language-out when processing ES6 modules</li>
<li>default to :ecmascript3 if :language-out not specified for :es6 module</li>
<li>inline some?</li>
</ul>
<h3 id="fixes">Fixes</h3>
<ul>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1911">CLJS-1911</a>: Need to bind Node.js require</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1909">CLJS-1909</a>: Self-host: circular dependency when requiring cljs.reader</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1906">CLJS-1906</a>: Self-host: script/test-self-parity fails</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1903">CLJS-1903</a>: Remove anonymous vars from dir and apropos output</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1897">CLJS-1897</a>: Too many externs generated</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1895">CLJS-1895</a>: Externs inference needs to support user supplied externs</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1873">CLJS-1873</a>: Self-host: Unit tests fail owing to test.check dep</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1874">CLJS-1874</a>: Self-host: :fn-var true for macros</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1877">CLJS-1877</a>: :foreign-libs entries should be allowed to specify directories along with individual files</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1890">CLJS-1890</a>: s/form for s/nilable in cljs.spec does not match clojure.spec</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1811">CLJS-1811</a>: Can&#39;t compose cljs.spec.test.instrument (or cljs.spec.test.check) with cljs.spec.test.enumerate-namespace</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1894">CLJS-1894</a>: Unnecessary analysis of core.cljs on first compile</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1893">CLJS-1893</a>: Unnecessary analysis of core.cljs</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1892">CLJS-1892</a>: Dependencies in JARs are analyzed every time even if an analysis cache file exists</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1887">CLJS-1887</a>: add :watch-error-fn option</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1883">CLJS-1883</a> Foreign libs can&#39;t be found on Node.js</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1882">CLJS-1882</a> Fix constant table sort order when using :modules</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1853">CLJS-1853</a>: var metadata in compiled output</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1878">CLJS-1878</a>: prefer <code>some?</code> over <code>(not (nil? %))</code> in analyzer</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1880">CLJS-1880</a>: missing ^boolean on some hasNext calls</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1875">CLJS-1875</a> Difference in seqable? between CLJ &amp; CLJS</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1829">CLJS-1829</a>: get does not return not-found on negative indexes</li>
<li>cljs.spec.test/unstrument shouldn&#39;t return the names of vars that weren&#39;t instrumented in the first place. Fixes <a href="http://dev.clojure.org/jira/browse/CLJS-1812">CLJS-1812</a></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1786">CLJS-1786</a>: Add knob for controlling printing of namespaced maps</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1836">CLJS-1836</a>: nth doesn&#39;t throw for IndexedSeqs</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1870">CLJS-1870</a>: Quoted specs check in require macro symbols</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1869">CLJS-1869</a>: Regression importing goog.Uri</li>
<li>Fix <a href="http://dev.clojure.org/jira/browse/CLJS-1653">CLJS-1653</a> regression</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1860">CLJS-1860</a>: Resolve JS modules referred by their fully-qualified namespace</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1861">CLJS-1861</a>: Use usr/bin/env in build scripts for portability</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1857">CLJS-1857</a>: Fix self-host tests</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1855">CLJS-1855</a>: Subvec should implement IIterable</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1856">CLJS-1856</a>: Self-host: load-deps doesn&#39;t delegate to itself</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1651">CLJS-1651</a>: Self-host: Cannot replace core macro-function</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1848">CLJS-1848</a>: Analyzer can&#39;t find JS modules during macro-expansion</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1851">CLJS-1851</a>: Only output JS module processing time when <code>:compiler-stats</code> is true</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1850">CLJS-1850</a>: <em>unchecked-if</em> not declared ^:dynamic warning after commit a732f0</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1849">CLJS-1849</a>: Self-host: regression introduced by <a href="http://dev.clojure.org/jira/browse/CLJS-1794">CLJS-1794</a></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1844">CLJS-1844</a>: port over Maria Geller&#39;s externs file parsing code</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1845">CLJS-1845</a>: Assoc on subvec should throw if out of bounds</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1847">CLJS-1847</a>: REPL should recognize <code>clojure.core/load</code></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1745">CLJS-1745</a>: refer-clojure doesn&#39;t pull in previously excluded vars</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1794">CLJS-1794</a>: incomplete alias created for namespace cljs.spec warning under advanced compilation</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1834">CLJS-1834</a>: REPL regression, require of ns from the ns itself errors out in circular reference</li>
<li>fix ns aliasing regression for JS namespaces</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1837">CLJS-1837</a>: Port halt-when over from Clojure</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1820">CLJS-1820</a>: &quot;No such namespace&quot; warning when referring to JS module namespace without using alias</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1828">CLJS-1828</a>: Add <code>:rename</code> to <code>require</code>&#39;s docstring</li>
</ul>
</article><div><h2>API Additions</h2><div class="sep"></div><ul><li><a href="/api/cljs.build.api/add-package-jsons">cljs.build.api/add-package-jsons</a></li><li><a href="/api/cljs.build.api/node-inputs">cljs.build.api/node-inputs</a></li><li><a href="/api/cljs.build.api/node-module-deps">cljs.build.api/node-module-deps</a></li><li><a href="/api/cljs.core/STARprint-namespace-mapsSTAR">*print-namespace-maps*</a></li><li><a href="/api/cljs.core/STARwarn-on-inferSTAR">*warn-on-infer*</a></li><li><a href="/api/cljs.core/PersistentArrayMapDOTcreateAsIfByAssoc">PersistentArrayMap.createAsIfByAssoc</a></li><li><a href="/api/cljs.core/PersistentArrayMapDOTcreateWithCheck">PersistentArrayMap.createWithCheck</a></li><li><a href="/api/cljs.core/PersistentHashMapDOTcreateWithCheck">PersistentHashMap.createWithCheck</a></li><li><a href="/api/cljs.core/PersistentHashSetDOTcreateAsIfByAssoc">PersistentHashSet.createAsIfByAssoc</a></li><li><a href="/api/cljs.core/PersistentHashSetDOTcreateWithCheck">PersistentHashSet.createWithCheck</a></li><li><a href="/api/cljs.core/halt-when">halt-when</a></li><li><a href="/api/cljs.core/load">load (repl)</a></li><li><a href="/api/cljs.core/print-prefix-map">print-prefix-map</a></li><li><a href="/api/cljs.reader/add-data-readers">cljs.reader/add-data-readers</a></li><li><a href="/api/cljs.spec.impl.gen/frequency">cljs.spec.impl.gen/frequency</a></li><li><a href="/api/cljs.spec/Specize">cljs.spec/Specize</a></li><li><a href="/api/cljs.spec/invalidQMARK">cljs.spec/invalid?</a></li><li><a href="/api/cljs.spec/nonconforming">cljs.spec/nonconforming</a></li></ul></div></div></div></div></div><footer class="site-footer"><div class="wrapper"><hr /><div class="cljs-legal">ClojureScript is licensed <a href="http://opensource.org/licenses/eclipse-1.0.php">EPL 1.0</a><br />Copyright Â© Rich Hickey</div></div></footer></div></body></html>