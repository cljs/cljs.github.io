<html><head><meta charset="utf-8" /><meta content="IE=edge" http-equiv="X-UA-Compatible" /><meta content="width=device-width, initial-scale=1" name="viewport" /><title>CLJS - 1.9.660</title><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" /><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet" /><link href="/css/normalize.css" rel="stylesheet" /><link href="/css/skeleton.css" rel="stylesheet" /><link href="/css/custom.css" rel="stylesheet" /><link href="/css/github-theme.css" rel="stylesheet" /><link href="/img/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57" /><link href="/img/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114" /><link href="/img/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72" /><link href="/img/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144" /><link href="/img/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60" /><link href="/img/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120" /><link href="/img/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76" /><link href="/img/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152" /><link href="/img/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" /><link href="/img/icons/favicon-192x192.png" rel="icon" sizes="192x192" type="image/png" /><link href="/img/icons/favicon-160x160.png" rel="icon" sizes="160x160" type="image/png" /><link href="/img/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png" /><link href="/img/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png" /><link href="/img/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png" /></head><body><div class="container"><nav class="navbar"><div class="container"><ul class="navbar-list"><li class="navbar-item"><a class="navbar-link-logo"><img class="navbar-logo" src="/img/cljs-white.svg" /></a></li><li class="navbar-item"><a class="navbar-title">ClojureScript</a></li><li class="navbar-item"><a class="navbar-link" href="/api">API</a></li><li class="navbar-item"><a class="navbar-link" href="/news">News</a></li><li class="navbar-item"><a class="navbar-link" href="https://github.com/clojure/clojurescript" target="_blank">GitHub</a></li></ul></div></nav><div class="container"><div class="row"><div class="three columns" style="overflow-x: hidden"><div class="news-sidebar"><div><a href="/versions">Version Details</a></div><div class="sep"></div><div><span class="version"><a href="/news/1.10.439">1.10.439</a></span></div><div><span class="version"><a href="/news/1.10.312">1.10.312</a></span></div><div><span class="version"><a href="/news/1.10.238">1.10.238</a></span></div><div><span class="version"><a href="/news/1.9.946">1.9.946</a></span></div><div><span class="version"><a href="/news/1.9.908">1.9.908</a></span></div><div><span class="version"><a href="/news/1.9.854">1.9.854</a></span></div><div><span class="version"><a href="/news/1.9.671">1.9.671</a></span></div><div class="active"><span class="version"><a href="/news/1.9.660">1.9.660</a></span></div><div><span class="version"><a href="/news/1.9.562">1.9.562</a></span></div><div><span class="version"><a href="/news/1.9.542">1.9.542</a></span></div><div><span class="version"><a href="/news/1.9.521">1.9.521</a></span></div><div><span class="version"><a href="/news/1.9.494">1.9.494</a></span></div><div><span class="version"><a href="/news/1.9.473">1.9.473</a></span></div><div><span class="version"><a href="/news/1.9.456">1.9.456</a></span></div><div><span class="version"><a href="/news/1.9.293">1.9.293</a></span></div><div><span class="version"><a href="/news/1.9.229">1.9.229</a></span></div><div><span class="version"><a href="/news/1.9.216">1.9.216</a></span></div><div><span class="version"><a href="/news/1.9.198">1.9.198</a></span></div><div><span class="version"><a href="/news/1.9.89">1.9.89</a></span></div><div><span class="version"><a href="/news/1.9.76">1.9.76</a></span></div><div><span class="version"><a href="/news/1.9.36">1.9.36</a></span></div><div><span class="version"><a href="/news/1.9.14">1.9.14</a></span></div><div><span class="version"><a href="/news/1.8.51">1.8.51</a></span></div><div><span class="version"><a href="/news/1.8.40">1.8.40</a></span></div><div><span class="version"><a href="/news/1.8.34">1.8.34</a></span></div><div><span class="version"><a href="/news/1.7.228">1.7.228</a></span></div><div><span class="version"><a href="/news/1.7.170">1.7.170</a></span></div><div><span class="version"><a href="/news/1.7.145">1.7.145</a></span></div><div><span class="version"><a href="/news/1.7.48">1.7.48</a></span></div><div><span class="version"><a href="/news/1.7.28">1.7.28</a></span></div><div><span class="version"><a href="/news/0.0-3308">0.0-3308</a></span></div><div><span class="version"><a href="/news/0.0-3255">0.0-3255</a></span></div><div><span class="version"><a href="/news/0.0-3211">0.0-3211</a></span></div><div><span class="version"><a href="/news/0.0-3196">0.0-3196</a></span></div><div><span class="version"><a href="/news/0.0-3126">0.0-3126</a></span></div><div><span class="version"><a href="/news/0.0-3115">0.0-3115</a></span></div><div><span class="version"><a href="/news/0.0-3058">0.0-3058</a></span></div><div><span class="version"><a href="/news/0.0-2913">0.0-2913</a></span></div><div><span class="version"><a href="/news/0.0-2843">0.0-2843</a></span></div><div><span class="version"><a href="/news/0.0-2814">0.0-2814</a></span></div><div><span class="version"><a href="/news/0.0-2755">0.0-2755</a></span></div><div><span class="version"><a href="/news/0.0-2740">0.0-2740</a></span></div><div><span class="version"><a href="/news/0.0-2719">0.0-2719</a></span></div><div><span class="version"><a href="/news/0.0-2644">0.0-2644</a></span></div><div><span class="version"><a href="/news/0.0-2505">0.0-2505</a></span></div><div><span class="version"><a href="/news/0.0-2496">0.0-2496</a></span></div><div><span class="version"><a href="/news/0.0-2411">0.0-2411</a></span></div><div><span class="version"><a href="/news/0.0-2371">0.0-2371</a></span></div><div><span class="version"><a href="/news/0.0-2356">0.0-2356</a></span></div><div><span class="version"><a href="/news/0.0-2341">0.0-2341</a></span></div><div><span class="version"><a href="/news/0.0-2322">0.0-2322</a></span></div><div><span class="version"><a href="/news/0.0-2311">0.0-2311</a></span></div><div><span class="version"><a href="/news/0.0-2301">0.0-2301</a></span></div><div><span class="version"><a href="/news/0.0-2280">0.0-2280</a></span></div><div><span class="version"><a href="/news/0.0-2277">0.0-2277</a></span></div><div><span class="version"><a href="/news/0.0-2268">0.0-2268</a></span></div><div><span class="version"><a href="/news/0.0-2261">0.0-2261</a></span></div><div><span class="version"><a href="/news/0.0-2234">0.0-2234</a></span></div><div><span class="version"><a href="/news/0.0-2227">0.0-2227</a></span></div><div><span class="version"><a href="/news/0.0-2202">0.0-2202</a></span></div><div><span class="version"><a href="/news/0.0-2199">0.0-2199</a></span></div><div><span class="version"><a href="/news/0.0-2197">0.0-2197</a></span></div><div><span class="version"><a href="/news/0.0-2173">0.0-2173</a></span></div><div><span class="version"><a href="/news/0.0-2156">0.0-2156</a></span></div><div><span class="version"><a href="/news/0.0-2138">0.0-2138</a></span></div><div><span class="version"><a href="/news/0.0-2134">0.0-2134</a></span></div><div><span class="version"><a href="/news/0.0-2127">0.0-2127</a></span></div><div><span class="version"><a href="/news/0.0-2120">0.0-2120</a></span></div><div><span class="version"><a href="/news/0.0-2067">0.0-2067</a></span></div><div><span class="version"><a href="/news/0.0-2060">0.0-2060</a></span></div><div><span class="version"><a href="/news/0.0-2030">0.0-2030</a></span></div><div><span class="version"><a href="/news/0.0-2024">0.0-2024</a></span></div><div><span class="version"><a href="/news/0.0-2014">0.0-2014</a></span></div><div><span class="version"><a href="/news/0.0-1978">0.0-1978</a></span></div><div><span class="version"><a href="/news/0.0-1934">0.0-1934</a></span></div><div><span class="version"><a href="/news/0.0-1933">0.0-1933</a></span></div><div><span class="version"><a href="/news/0.0-1913">0.0-1913</a></span></div><div><span class="version"><a href="/news/0.0-1909">0.0-1909</a></span></div><div><span class="version"><a href="/news/0.0-1885">0.0-1885</a></span></div><div><span class="version"><a href="/news/0.0-1877">0.0-1877</a></span></div><div><span class="version"><a href="/news/0.0-1859">0.0-1859</a></span></div><div><span class="version"><a href="/news/0.0-1847">0.0-1847</a></span></div><div><span class="version"><a href="/news/0.0-1798">0.0-1798</a></span></div><div><span class="version"><a href="/news/0.0-1586">0.0-1586</a></span></div><div><span class="version"><a href="/news/0.0-1535">0.0-1535</a></span></div><div><span class="version"><a href="/news/0.0-1513">0.0-1513</a></span></div><div><span class="version"><a href="/news/0.0-1503">0.0-1503</a></span></div><div><span class="version"><a href="/news/0.0-1443">0.0-1443</a></span></div><div><span class="version"><a href="/news/0.0-1236">0.0-1236</a></span></div><div><span class="version"><a href="/news/0.0-1211">0.0-1211</a></span></div><div><span class="version"><a href="/news/0.0-971">0.0-971</a></span></div><div><span class="version"><a href="/news/0.0-927">0.0-927</a></span></div></div></div><div class="nine columns"><div><h2>1.9.660 - compiler performance, runtime performance, cljs.spec fixes</h2><p>Jun 27, 2017 by David Nolen <a href="https://groups.google.com/d/msg/clojurescript/GGxwZgUetLE/fHfRQH1mAAAJ">on Google Groups</a></p><article><p>This release includes many performance enhancements to the
ClojureScript compiler as well as ClojureScript runtime code. In
addition, the release contains fixes to cljs.spec so that it works
correctly under incremental compilation.</p>
<p>For more information please refer to the new post here kindly
contributed by Mike Fikes:
<a href="https://clojurescript.org/news/2017-06-27-faster-compilation-runtime-and-spec-caching-fixes">https://clojurescript.org/news/2017-06-27-faster-compilation-runtime-and-spec-caching-fixes</a></p>
<p>Thanks to all that contributed, and as always, feedback welcome!</p>
<h3 id="enhancements">Enhancements</h3>
<ul>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2108">CLJS-2108</a>: faster set equivalence</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2099">CLJS-2099</a>: Optimize apply by avoiding .apply</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2046">CLJS-2046</a>: Optimize expression in call position</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1876">CLJS-1876</a>: Faster reduce for PV, Subvec and ChunkedSeq</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2080">CLJS-2080</a>: Faster equiv-map</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2066">CLJS-2066</a>: Avoid analyzing named fn literal bodies twice</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2065">CLJS-2065</a>: Improve analyzer munge performance</li>
</ul>
<h3 id="changes">Changes</h3>
<ul>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2134">CLJS-2134</a>: Warn on variadic signatures in protocol method implementation</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2130">CLJS-2130</a>: Self-host: Add <code>:fn-invoke-direct</code> to public API docstrings</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2112">CLJS-2112</a>: Iterator based reduce path</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2100">CLJS-2100</a>: to-array calls seq too often</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2041">CLJS-2041</a>: Compiler flag to drop Function.prototype.call invokes</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2093">CLJS-2093</a>: inline ^:const var values</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2042">CLJS-2042</a>: Variadic invoke calls array_seq inefficiently</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2003">CLJS-2003</a> remove redundant calls to <code>str</code> in munge/demunge</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1907">CLJS-1907</a>: Improve error message from cljs.reader/read-string</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1724">CLJS-1724</a>: Include IIterable in fast-path-protocols</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-924">CLJS-924</a>: Better error message for mistaken use of &#39;def&#39;</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1599">CLJS-1599</a>: UUIDs are not equal for upper/lower case strings</li>
<li>NodeJS REPL accepts a :path opt to set NODE_PATH</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1886">CLJS-1886</a>: RangedIterator should only be created from cljs.core.PersistentVector instances</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2068">CLJS-2068</a>: MapEntry, RedNode and BlackNode are IComparable</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2073">CLJS-2073</a>: Don&#39;t flush for every emitted line</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2089">CLJS-2089</a>: Warn message wrong for recur to protocol with nil</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2085">CLJS-2085</a>: defrecord recur method head target object</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1977">CLJS-1977</a>: defrecord should use murmur hashing like Clojure</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2076">CLJS-2076</a>: modules should support wildcard namespaces</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2078">CLJS-2078</a>: add resolve macro</li>
</ul>
<h3 id="fixes">Fixes</h3>
<ul>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2133">CLJS-2133</a>: Invalid variadic IFn implementations now fail</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2128">CLJS-2128</a>: Fix regression in <a href="http://dev.clojure.org/jira/browse/CLJS-1886">CLJS-1886</a></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2126">CLJS-2126</a>: Add new compiler option :fn-invoke-direct to build-affecting options</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2054">CLJS-2054</a>: Private core names still result in &quot;already declared&quot; warnings</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2125">CLJS-2125</a>: Duplicate HOF invoke warnings if :static-fns true</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2119">CLJS-2119</a>: s/form for s/&amp; is qualified with <code>clojure.spec.alpha</code></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2121">CLJS-2121</a>: Self-host: Document string as valid name arg</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2124">CLJS-2124</a>: Self-host: Tests failing wth Could not find tag parser for :cljs.spec.alpha</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2122">CLJS-2122</a>: Self-host: Non-symbol ns names dumped into env</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2117">CLJS-2117</a>: Self-host: Port <a href="http://dev.clojure.org/jira/browse/CLJS-1989">CLJS-1989</a> to self-hosted</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1989">CLJS-1989</a>: s/fdef expansion side effect fails when load cached source</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2116">CLJS-2116</a>: Need to handle un-namespaced symbol when evaluating <code>foo.core</code></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2109">CLJS-2109</a>: incorrect syntax-quote symbol resolution (resolve-symbol &#39;clojure.core) -&gt; &#39;clojure/core</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2113">CLJS-2113</a>: nth function produces different results from clojure when using a negative index on a sequence</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2115">CLJS-2115</a>: Pass not-found in the native-satisfies? branch of nth</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2111">CLJS-2111</a>: Transit analysis caching broken for JSValue or regex</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2101">CLJS-2101</a>: Undeclared var in do chain of defs</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2104">CLJS-2104</a>: Const-replaced exprs do not emit js &quot;return&quot;</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1992">CLJS-1992</a>: declare after def should have no effect</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1251">CLJS-1251</a>: Missing semicolons when emitting deftype and defrecord mistaken use of &#39;def&#39;</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1685">CLJS-1685</a>: Incorrectly lazy subvec when start param is nil</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1641">CLJS-1641</a>: Multi-arity defn copies arguments unnecessarily for all cases</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2092">CLJS-2092</a>: Redundant call to equiv-map in PAM.-equiv</li>
<li>Check for compilation success, and lib folder</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2030">CLJS-2030</a>: Case with grouped keyword test emit result-expr multiple times</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2094">CLJS-2094</a>: Predicates unit tests constructs a uuid with nil</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-1891">CLJS-1891</a>: UUID.toString can return non-string</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2072">CLJS-2072</a>: Eliminate reflection in cljs.js-deps/build-index</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2012">CLJS-2012</a>: Find on PHM with nil entry always returns nil entry</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2057">CLJS-2057</a>: fix language-in options (es6 deprecated and add missing es2016)</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2060">CLJS-2060</a>: Backport <a href="http://dev.clojure.org/jira/browse/CLJ-2141">CLJ-2141</a> Return only true/false from qualified-* predicates</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2091">CLJS-2091</a>: reify docstring ISeqable example needs correction</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2088">CLJS-2088</a>: fix caching collision between macros ns and regular ns in boostrap</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2036">CLJS-2036</a>: Relative path exception thrown when :preloads requires a :foreign-lib</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2083">CLJS-2083</a>: Test equiv-map for maps which do not impl IKVReduce</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2081">CLJS-2081</a>: Self-host: Regression with <a href="http://dev.clojure.org/jira/browse/CLJS-2079">CLJS-2079</a></li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2079">CLJS-2079</a>: Records and maps are not equal</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2075">CLJS-2075</a>: PersistentTreeMap.reduce-kv does not honor reduced?</li>
<li>Browser REPL regression</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2069">CLJS-2069</a>: Self-host: automatic <code>clojure</code> -&gt; <code>cljs</code> aliasing doesn&#39;t work when loading macro namespaces</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2067">CLJS-2067</a>: reduce-kv / inode-kv-reduce fails to honor reduced?</li>
<li><a href="http://dev.clojure.org/jira/browse/CLJS-2056">CLJS-2056</a>: Self-host: test-self-parity failing wrt cljs.core/fn symbol</li>
</ul>
</article><div><h2>API Additions</h2><div><em>including pre-release 1.9.655</em></div><div class="sep"></div><ul><li><a href="/api/cljs.core/APersistentVector">APersistentVector</a></li><li><a href="/api/cljs.core/equiv-map">equiv-map</a></li><li><a href="/api/cljs.core/gen-apply-to-simple">gen-apply-to-simple</a></li><li><a href="/api/cljs.core/resolve">resolve</a></li><li><a href="/api/compiler-options/fn-invoke-direct">compiler-options/fn-invoke-direct</a></li><li><a href="/api/compiler-options/warnings#protocol-impl-recur-with-target">warnings/protocol-impl-recur-with-target</a></li><li><a href="/api/compiler-options/warnings#protocol-impl-with-variadic-method">warnings/protocol-impl-with-variadic-method</a></li></ul></div></div></div></div></div><footer class="site-footer"><div class="wrapper"><hr /><div class="cljs-legal">ClojureScript is licensed <a href="http://opensource.org/licenses/eclipse-1.0.php">EPL 1.0</a><br />Copyright © Rich Hickey</div></div></footer></div><script src="/js/client.js"></script></body></html>